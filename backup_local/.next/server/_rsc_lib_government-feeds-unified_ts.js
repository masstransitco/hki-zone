"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_lib_government-feeds-unified_ts";
exports.ids = ["_rsc_lib_government-feeds-unified_ts"];
exports.modules = {

/***/ "(rsc)/./lib/government-feeds-unified.ts":
/*!*****************************************!*\
  !*** ./lib/government-feeds-unified.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UnifiedGovernmentFeeds: () => (/* binding */ UnifiedGovernmentFeeds),\n/* harmony export */   getUnifiedFeeds: () => (/* binding */ getUnifiedFeeds)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var rss_parser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rss-parser */ \"(rsc)/./node_modules/rss-parser/index.js\");\n/* harmony import */ var rss_parser__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rss_parser__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var xml2js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! xml2js */ \"(rsc)/./node_modules/xml2js/lib/xml2js.js\");\n/* harmony import */ var xml2js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(xml2js__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n\nclass UnifiedGovernmentFeeds {\n    constructor(){\n        this.parser = new (rss_parser__WEBPACK_IMPORTED_MODULE_0___default())({\n            timeout: 30000,\n            headers: {\n                \"User-Agent\": \"Mozilla/5.0 (compatible; HKI-Zone/1.0)\"\n            },\n            customFields: {\n                item: [\n                    \"description\",\n                    \"content:encoded\",\n                    \"link\",\n                    \"guid\",\n                    \"pubDate\"\n                ]\n            }\n        });\n        this.xmlParser = new (xml2js__WEBPACK_IMPORTED_MODULE_2___default().Parser)({\n            explicitArray: false,\n            mergeAttrs: true\n        });\n        // Initialize Supabase client\n        this.supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_3__.createClient)(\"https://egyuetfeubznhcvmtary.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\n    }\n    /**\n   * Main processing function - fetches all active feeds and processes them\n   */ async processAllFeeds() {\n        console.log(\"Starting unified feed processing...\");\n        // Get all active feed configurations\n        const { data: feeds, error } = await this.supabase.from(\"gov_feeds_unified\").select(\"*\").eq(\"active\", true);\n        if (error || !feeds) {\n            console.error(\"Error fetching feed configurations:\", error);\n            return;\n        }\n        // Group feeds by base_slug to process all languages together\n        const feedGroups = this.groupFeedsByBaseSlug(feeds);\n        // Process each feed group\n        for (const [baseSlug, feedGroup] of Object.entries(feedGroups)){\n            console.log(`Processing feed group: ${baseSlug}`);\n            try {\n                await this.processFeedGroup(baseSlug, feedGroup);\n            } catch (error) {\n                console.error(`Error processing feed group ${baseSlug}:`, error);\n            }\n        }\n        console.log(\"Feed processing completed\");\n    }\n    /**\n   * Process a group of feeds (all language variants of same feed)\n   */ async processFeedGroup(baseSlug, feedGroup) {\n        const multilingualItems = new Map();\n        // Fetch all language variants\n        for (const [lang, url] of Object.entries({\n            en: feedGroup.url_en,\n            \"zh-TW\": feedGroup.url_zh_tw,\n            \"zh-CN\": feedGroup.url_zh_cn\n        })){\n            if (!url) continue;\n            console.log(`Fetching ${lang} feed from: ${url}`);\n            try {\n                const items = await this.fetchFeed(url, baseSlug);\n                // Merge items into multilingual structure\n                for (const item of items){\n                    const key = this.generateItemKey(item);\n                    if (!multilingualItems.has(key)) {\n                        multilingualItems.set(key, {});\n                    }\n                    const content = multilingualItems.get(key);\n                    content[lang] = item;\n                }\n                // Update last fetch timestamp\n                const updateField = `last_fetch_${lang.toLowerCase().replace(\"-\", \"_\")}`;\n                await this.supabase.from(\"gov_feeds_unified\").update({\n                    [updateField]: new Date().toISOString()\n                }).eq(\"id\", feedGroup.id);\n            } catch (error) {\n                console.error(`Error fetching ${lang} feed:`, error);\n            }\n        }\n        // Store unified incidents\n        await this.storeUnifiedIncidents(feedGroup, multilingualItems);\n    }\n    /**\n   * Fetch and parse a single feed\n   */ async fetchFeed(url, baseSlug) {\n        // Special handling for Transport Department feeds\n        if (baseSlug.startsWith(\"td_\")) {\n            return this.fetchTransportDeptFeed(url);\n        }\n        // Standard RSS parsing\n        try {\n            const feed = await this.parser.parseURL(url);\n            return feed.items.map((item)=>({\n                    guid: item.guid || item.link || \"\",\n                    title: this.cleanText(item.title || \"\"),\n                    body: this.cleanText(item.description || item[\"content:encoded\"] || \"\"),\n                    link: item.link || \"\",\n                    pubDate: new Date(item.pubDate || Date.now())\n                }));\n        } catch (error) {\n            console.error(`Error parsing RSS feed ${url}:`, error);\n            return [];\n        }\n    }\n    /**\n   * Special parser for Transport Department XML feeds\n   */ async fetchTransportDeptFeed(url) {\n        try {\n            const response = await fetch(url, {\n                headers: {\n                    \"User-Agent\": \"Mozilla/5.0 (compatible; HKI-Zone/1.0)\"\n                }\n            });\n            const xml = await response.text();\n            const result = await this.xmlParser.parseStringPromise(xml);\n            const messages = result?.message?.messages || [];\n            const items = [];\n            for (const msg of Array.isArray(messages) ? messages : [\n                messages\n            ]){\n                if (!msg) continue;\n                const msgId = msg.msgID || msg.msg_id || \"\";\n                const issueDate = msg.issueDate || msg.issue_date || \"\";\n                const content = msg.content || msg.description || \"\";\n                const heading = msg.heading || msg.title || \"\";\n                items.push({\n                    guid: `td_${msgId}`,\n                    title: this.cleanText(heading),\n                    body: this.cleanText(content),\n                    link: url,\n                    pubDate: new Date(issueDate || Date.now())\n                });\n            }\n            return items;\n        } catch (error) {\n            console.error(`Error parsing Transport Dept feed ${url}:`, error);\n            return [];\n        }\n    }\n    /**\n   * Generate a unique key for matching items across languages\n   */ generateItemKey(item) {\n        // Use publish date + partial content hash for matching\n        const dateKey = item.pubDate.toISOString().split(\"T\")[0];\n        const contentHash = (0,crypto__WEBPACK_IMPORTED_MODULE_1__.createHash)(\"sha256\").update(item.title.substring(0, 50)).digest(\"hex\").substring(0, 8);\n        return `${dateKey}_${contentHash}`;\n    }\n    /**\n   * Store unified incidents with multilingual content\n   */ async storeUnifiedIncidents(feedConfig, multilingualItems) {\n        const incidents = [];\n        for (const [key, content] of multilingualItems){\n            // Get primary item (prefer English)\n            const primaryItem = content.en || content[\"zh-TW\"] || content[\"zh-CN\"];\n            if (!primaryItem) continue;\n            // Generate content hash for deduplication\n            const contentHash = this.generateContentHash(content);\n            // Build multilingual content structure\n            const multilingualContent = {};\n            for (const [lang, item] of Object.entries(content)){\n                if (item) {\n                    multilingualContent[lang] = {\n                        title: item.title,\n                        body: item.body,\n                        link: item.link\n                    };\n                }\n            }\n            incidents.push({\n                feed_id: feedConfig.id,\n                source_guid: primaryItem.guid,\n                source_published_at: primaryItem.pubDate.toISOString(),\n                content: multilingualContent,\n                category: \"gov\",\n                severity: this.calculateSeverity(primaryItem),\n                relevance_score: this.calculateRelevance(primaryItem),\n                content_hash: contentHash\n            });\n        }\n        // Batch upsert incidents\n        if (incidents.length > 0) {\n            const { error } = await this.supabase.from(\"incidents_unified\").upsert(incidents, {\n                onConflict: \"content_hash\",\n                ignoreDuplicates: true\n            });\n            if (error) {\n                console.error(`Error storing incidents for ${feedConfig.base_slug}:`, error);\n            } else {\n                console.log(`Stored ${incidents.length} unified incidents for ${feedConfig.base_slug}`);\n            }\n        }\n    }\n    /**\n   * Calculate severity based on content keywords\n   */ calculateSeverity(item) {\n        const content = `${item.title} ${item.body}`.toLowerCase();\n        // High severity keywords\n        if (content.match(/urgent|emergency|severe|critical|immediate|major disruption|suspended/)) {\n            return 5;\n        }\n        // Medium-high severity\n        if (content.match(/disruption|delayed|affected|diverted|closed|suspended/)) {\n            return 4;\n        }\n        // Medium severity\n        if (content.match(/temporary|relocation|special traffic|arrangement/)) {\n            return 3;\n        }\n        // Default\n        return 2;\n    }\n    /**\n   * Calculate relevance score based on content\n   */ calculateRelevance(item) {\n        const now = new Date();\n        const hoursSincePublished = (now.getTime() - item.pubDate.getTime()) / (1000 * 60 * 60);\n        // Time-based decay\n        let score = Math.max(0, 1 - hoursSincePublished / 168) // 7 days decay\n        ;\n        // Boost for severity keywords\n        const content = `${item.title} ${item.body}`.toLowerCase();\n        if (content.match(/urgent|emergency|severe/)) {\n            score = Math.min(1, score + 0.3);\n        }\n        return Math.round(score * 100) / 100;\n    }\n    /**\n   * Generate content hash for deduplication\n   */ generateContentHash(content) {\n        const combined = Object.entries(content).sort(([a], [b])=>a.localeCompare(b)).map(([lang, item])=>`${lang}:${item?.title}:${item?.body}`).join(\"|\");\n        return (0,crypto__WEBPACK_IMPORTED_MODULE_1__.createHash)(\"sha256\").update(combined).digest(\"hex\");\n    }\n    /**\n   * Clean text content\n   */ cleanText(text) {\n        if (!text) return \"\";\n        return text.replace(/<[^>]*>/g, \"\") // Remove HTML tags\n        .replace(/&nbsp;/g, \" \").replace(/&amp;/g, \"&\").replace(/&lt;/g, \"<\").replace(/&gt;/g, \">\").replace(/&quot;/g, '\"').replace(/&#039;/g, \"'\").replace(/\\s+/g, \" \").trim();\n    }\n    /**\n   * Group feeds by base slug\n   */ groupFeedsByBaseSlug(feeds) {\n        const groups = {};\n        for (const feed of feeds){\n            groups[feed.base_slug] = feed;\n        }\n        return groups;\n    }\n}\n// Export singleton instance getter\nlet instance = null;\nfunction getUnifiedFeeds() {\n    if (!instance) {\n        instance = new UnifiedGovernmentFeeds();\n    }\n    return instance;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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OztHQUVDLEdBQ0QsVUFBa0JuQixJQUFZLEVBQVU7UUFDdEMsSUFBSSxDQUFDQSxNQUFNLE9BQU87UUFFbEIsT0FBT0EsS0FDSnRCLE9BQU8sQ0FBQyxZQUFZLElBQUksbUJBQW1CO1NBQzNDQSxPQUFPLENBQUMsV0FBVyxLQUNuQkEsT0FBTyxDQUFDLFVBQVUsS0FDbEJBLE9BQU8sQ0FBQyxTQUFTLEtBQ2pCQSxPQUFPLENBQUMsU0FBUyxLQUNqQkEsT0FBTyxDQUFDLFdBQVcsS0FDbkJBLE9BQU8sQ0FBQyxXQUFXLEtBQ25CQSxPQUFPLENBQUMsUUFBUSxLQUNoQjJFLElBQUk7SUFDVDtJQUVBOztHQUVDLEdBQ0QscUJBQTZCekcsS0FBWSxFQUF1QjtRQUM5RCxNQUFNMEcsU0FBOEIsQ0FBQztRQUVyQyxLQUFLLE1BQU1wRSxRQUFRdEMsTUFBTztZQUN4QjBHLE1BQU0sQ0FBQ3BFLEtBQUtvRCxTQUFTLENBQUMsR0FBR3BEO1FBQzNCO1FBRUEsT0FBT29FO0lBQ1Q7QUFDRjtBQUVBLG1DQUFtQztBQUNuQyxJQUFJQyxXQUEwQztBQUV2QyxTQUFTQztJQUNkLElBQUksQ0FBQ0QsVUFBVTtRQUNiQSxXQUFXLElBQUk5SDtJQUNqQjtJQUNBLE9BQU84SDtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaGtpLXpvbmUvLi9saWIvZ292ZXJubWVudC1mZWVkcy11bmlmaWVkLnRzP2FjMTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50LCBTdXBhYmFzZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcbmltcG9ydCBQYXJzZXIgZnJvbSAncnNzLXBhcnNlcidcbmltcG9ydCB7IGNyZWF0ZUhhc2ggfSBmcm9tICdjcnlwdG8nXG5pbXBvcnQgeG1sMmpzIGZyb20gJ3htbDJqcydcblxuaW50ZXJmYWNlIFVuaWZpZWRGZWVkSXRlbSB7XG4gIGd1aWQ6IHN0cmluZ1xuICB0aXRsZTogc3RyaW5nXG4gIGJvZHk6IHN0cmluZ1xuICBsaW5rOiBzdHJpbmdcbiAgcHViRGF0ZTogRGF0ZVxufVxuXG5pbnRlcmZhY2UgTXVsdGlsaW5ndWFsQ29udGVudCB7XG4gIGVuPzogVW5pZmllZEZlZWRJdGVtXG4gICd6aC1UVyc/OiBVbmlmaWVkRmVlZEl0ZW1cbiAgJ3poLUNOJz86IFVuaWZpZWRGZWVkSXRlbVxufVxuXG5leHBvcnQgY2xhc3MgVW5pZmllZEdvdmVybm1lbnRGZWVkcyB7XG4gIHByaXZhdGUgcGFyc2VyOiBQYXJzZXJcbiAgcHJpdmF0ZSB4bWxQYXJzZXI6IHhtbDJqcy5QYXJzZXJcbiAgcHJpdmF0ZSBzdXBhYmFzZTogU3VwYWJhc2VDbGllbnRcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnBhcnNlciA9IG5ldyBQYXJzZXIoe1xuICAgICAgdGltZW91dDogMzAwMDAsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChjb21wYXRpYmxlOyBIS0ktWm9uZS8xLjApJyxcbiAgICAgIH0sXG4gICAgICBjdXN0b21GaWVsZHM6IHtcbiAgICAgICAgaXRlbTogWydkZXNjcmlwdGlvbicsICdjb250ZW50OmVuY29kZWQnLCAnbGluaycsICdndWlkJywgJ3B1YkRhdGUnXVxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgdGhpcy54bWxQYXJzZXIgPSBuZXcgeG1sMmpzLlBhcnNlcih7XG4gICAgICBleHBsaWNpdEFycmF5OiBmYWxzZSxcbiAgICAgIG1lcmdlQXR0cnM6IHRydWVcbiAgICB9KVxuICAgIFxuICAgIC8vIEluaXRpYWxpemUgU3VwYWJhc2UgY2xpZW50XG4gICAgdGhpcy5zdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChcbiAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgICBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBNYWluIHByb2Nlc3NpbmcgZnVuY3Rpb24gLSBmZXRjaGVzIGFsbCBhY3RpdmUgZmVlZHMgYW5kIHByb2Nlc3NlcyB0aGVtXG4gICAqL1xuICBhc3luYyBwcm9jZXNzQWxsRmVlZHMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS5sb2coJ1N0YXJ0aW5nIHVuaWZpZWQgZmVlZCBwcm9jZXNzaW5nLi4uJylcbiAgICBcbiAgICAvLyBHZXQgYWxsIGFjdGl2ZSBmZWVkIGNvbmZpZ3VyYXRpb25zXG4gICAgY29uc3QgeyBkYXRhOiBmZWVkcywgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdnb3ZfZmVlZHNfdW5pZmllZCcpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnYWN0aXZlJywgdHJ1ZSlcbiAgICBcbiAgICBpZiAoZXJyb3IgfHwgIWZlZWRzKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBmZWVkIGNvbmZpZ3VyYXRpb25zOicsIGVycm9yKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8gR3JvdXAgZmVlZHMgYnkgYmFzZV9zbHVnIHRvIHByb2Nlc3MgYWxsIGxhbmd1YWdlcyB0b2dldGhlclxuICAgIGNvbnN0IGZlZWRHcm91cHMgPSB0aGlzLmdyb3VwRmVlZHNCeUJhc2VTbHVnKGZlZWRzKVxuICAgIFxuICAgIC8vIFByb2Nlc3MgZWFjaCBmZWVkIGdyb3VwXG4gICAgZm9yIChjb25zdCBbYmFzZVNsdWcsIGZlZWRHcm91cF0gb2YgT2JqZWN0LmVudHJpZXMoZmVlZEdyb3VwcykpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nIGZlZWQgZ3JvdXA6ICR7YmFzZVNsdWd9YClcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5wcm9jZXNzRmVlZEdyb3VwKGJhc2VTbHVnLCBmZWVkR3JvdXApXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBwcm9jZXNzaW5nIGZlZWQgZ3JvdXAgJHtiYXNlU2x1Z306YCwgZXJyb3IpXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdGZWVkIHByb2Nlc3NpbmcgY29tcGxldGVkJylcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzIGEgZ3JvdXAgb2YgZmVlZHMgKGFsbCBsYW5ndWFnZSB2YXJpYW50cyBvZiBzYW1lIGZlZWQpXG4gICAqL1xuICBhc3luYyBwcm9jZXNzRmVlZEdyb3VwKGJhc2VTbHVnOiBzdHJpbmcsIGZlZWRHcm91cDogYW55KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgbXVsdGlsaW5ndWFsSXRlbXMgPSBuZXcgTWFwPHN0cmluZywgTXVsdGlsaW5ndWFsQ29udGVudD4oKVxuICAgIFxuICAgIC8vIEZldGNoIGFsbCBsYW5ndWFnZSB2YXJpYW50c1xuICAgIGZvciAoY29uc3QgW2xhbmcsIHVybF0gb2YgT2JqZWN0LmVudHJpZXMoe1xuICAgICAgZW46IGZlZWRHcm91cC51cmxfZW4sXG4gICAgICAnemgtVFcnOiBmZWVkR3JvdXAudXJsX3poX3R3LFxuICAgICAgJ3poLUNOJzogZmVlZEdyb3VwLnVybF96aF9jblxuICAgIH0pKSB7XG4gICAgICBpZiAoIXVybCkgY29udGludWVcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYEZldGNoaW5nICR7bGFuZ30gZmVlZCBmcm9tOiAke3VybH1gKVxuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBpdGVtcyA9IGF3YWl0IHRoaXMuZmV0Y2hGZWVkKHVybCBhcyBzdHJpbmcsIGJhc2VTbHVnKVxuICAgICAgICBcbiAgICAgICAgLy8gTWVyZ2UgaXRlbXMgaW50byBtdWx0aWxpbmd1YWwgc3RydWN0dXJlXG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xuICAgICAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2VuZXJhdGVJdGVtS2V5KGl0ZW0pXG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKCFtdWx0aWxpbmd1YWxJdGVtcy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgbXVsdGlsaW5ndWFsSXRlbXMuc2V0KGtleSwge30pXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBtdWx0aWxpbmd1YWxJdGVtcy5nZXQoa2V5KSFcbiAgICAgICAgICBjb250ZW50W2xhbmcgYXMga2V5b2YgTXVsdGlsaW5ndWFsQ29udGVudF0gPSBpdGVtXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSBsYXN0IGZldGNoIHRpbWVzdGFtcFxuICAgICAgICBjb25zdCB1cGRhdGVGaWVsZCA9IGBsYXN0X2ZldGNoXyR7bGFuZy50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoJy0nLCAnXycpfWBcbiAgICAgICAgYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgICAgIC5mcm9tKCdnb3ZfZmVlZHNfdW5pZmllZCcpXG4gICAgICAgICAgLnVwZGF0ZSh7IFt1cGRhdGVGaWVsZF06IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9KVxuICAgICAgICAgIC5lcSgnaWQnLCBmZWVkR3JvdXAuaWQpXG4gICAgICAgICAgXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBmZXRjaGluZyAke2xhbmd9IGZlZWQ6YCwgZXJyb3IpXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFN0b3JlIHVuaWZpZWQgaW5jaWRlbnRzXG4gICAgYXdhaXQgdGhpcy5zdG9yZVVuaWZpZWRJbmNpZGVudHMoZmVlZEdyb3VwLCBtdWx0aWxpbmd1YWxJdGVtcylcbiAgfVxuXG4gIC8qKlxuICAgKiBGZXRjaCBhbmQgcGFyc2UgYSBzaW5nbGUgZmVlZFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBmZXRjaEZlZWQodXJsOiBzdHJpbmcsIGJhc2VTbHVnOiBzdHJpbmcpOiBQcm9taXNlPFVuaWZpZWRGZWVkSXRlbVtdPiB7XG4gICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3IgVHJhbnNwb3J0IERlcGFydG1lbnQgZmVlZHNcbiAgICBpZiAoYmFzZVNsdWcuc3RhcnRzV2l0aCgndGRfJykpIHtcbiAgICAgIHJldHVybiB0aGlzLmZldGNoVHJhbnNwb3J0RGVwdEZlZWQodXJsKVxuICAgIH1cbiAgICBcbiAgICAvLyBTdGFuZGFyZCBSU1MgcGFyc2luZ1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmZWVkID0gYXdhaXQgdGhpcy5wYXJzZXIucGFyc2VVUkwodXJsKVxuICAgICAgXG4gICAgICByZXR1cm4gZmVlZC5pdGVtcy5tYXAoaXRlbSA9PiAoe1xuICAgICAgICBndWlkOiBpdGVtLmd1aWQgfHwgaXRlbS5saW5rIHx8ICcnLFxuICAgICAgICB0aXRsZTogdGhpcy5jbGVhblRleHQoaXRlbS50aXRsZSB8fCAnJyksXG4gICAgICAgIGJvZHk6IHRoaXMuY2xlYW5UZXh0KGl0ZW0uZGVzY3JpcHRpb24gfHwgaXRlbVsnY29udGVudDplbmNvZGVkJ10gfHwgJycpLFxuICAgICAgICBsaW5rOiBpdGVtLmxpbmsgfHwgJycsXG4gICAgICAgIHB1YkRhdGU6IG5ldyBEYXRlKGl0ZW0ucHViRGF0ZSB8fCBEYXRlLm5vdygpKVxuICAgICAgfSkpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHBhcnNpbmcgUlNTIGZlZWQgJHt1cmx9OmAsIGVycm9yKVxuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNwZWNpYWwgcGFyc2VyIGZvciBUcmFuc3BvcnQgRGVwYXJ0bWVudCBYTUwgZmVlZHNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2hUcmFuc3BvcnREZXB0RmVlZCh1cmw6IHN0cmluZyk6IFByb21pc2U8VW5pZmllZEZlZWRJdGVtW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgaGVhZGVyczogeyAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgSEtJLVpvbmUvMS4wKScgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgY29uc3QgeG1sID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnhtbFBhcnNlci5wYXJzZVN0cmluZ1Byb21pc2UoeG1sKVxuICAgICAgXG4gICAgICBjb25zdCBtZXNzYWdlcyA9IHJlc3VsdD8ubWVzc2FnZT8ubWVzc2FnZXMgfHwgW11cbiAgICAgIGNvbnN0IGl0ZW1zOiBVbmlmaWVkRmVlZEl0ZW1bXSA9IFtdXG4gICAgICBcbiAgICAgIGZvciAoY29uc3QgbXNnIG9mIEFycmF5LmlzQXJyYXkobWVzc2FnZXMpID8gbWVzc2FnZXMgOiBbbWVzc2FnZXNdKSB7XG4gICAgICAgIGlmICghbXNnKSBjb250aW51ZVxuICAgICAgICBcbiAgICAgICAgY29uc3QgbXNnSWQgPSBtc2cubXNnSUQgfHwgbXNnLm1zZ19pZCB8fCAnJ1xuICAgICAgICBjb25zdCBpc3N1ZURhdGUgPSBtc2cuaXNzdWVEYXRlIHx8IG1zZy5pc3N1ZV9kYXRlIHx8ICcnXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBtc2cuY29udGVudCB8fCBtc2cuZGVzY3JpcHRpb24gfHwgJydcbiAgICAgICAgY29uc3QgaGVhZGluZyA9IG1zZy5oZWFkaW5nIHx8IG1zZy50aXRsZSB8fCAnJ1xuICAgICAgICBcbiAgICAgICAgaXRlbXMucHVzaCh7XG4gICAgICAgICAgZ3VpZDogYHRkXyR7bXNnSWR9YCxcbiAgICAgICAgICB0aXRsZTogdGhpcy5jbGVhblRleHQoaGVhZGluZyksXG4gICAgICAgICAgYm9keTogdGhpcy5jbGVhblRleHQoY29udGVudCksXG4gICAgICAgICAgbGluazogdXJsLFxuICAgICAgICAgIHB1YkRhdGU6IG5ldyBEYXRlKGlzc3VlRGF0ZSB8fCBEYXRlLm5vdygpKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaXRlbXNcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcGFyc2luZyBUcmFuc3BvcnQgRGVwdCBmZWVkICR7dXJsfTpgLCBlcnJvcilcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBhIHVuaXF1ZSBrZXkgZm9yIG1hdGNoaW5nIGl0ZW1zIGFjcm9zcyBsYW5ndWFnZXNcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVJdGVtS2V5KGl0ZW06IFVuaWZpZWRGZWVkSXRlbSk6IHN0cmluZyB7XG4gICAgLy8gVXNlIHB1Ymxpc2ggZGF0ZSArIHBhcnRpYWwgY29udGVudCBoYXNoIGZvciBtYXRjaGluZ1xuICAgIGNvbnN0IGRhdGVLZXkgPSBpdGVtLnB1YkRhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdXG4gICAgY29uc3QgY29udGVudEhhc2ggPSBjcmVhdGVIYXNoKCdzaGEyNTYnKVxuICAgICAgLnVwZGF0ZShpdGVtLnRpdGxlLnN1YnN0cmluZygwLCA1MCkpXG4gICAgICAuZGlnZXN0KCdoZXgnKVxuICAgICAgLnN1YnN0cmluZygwLCA4KVxuICAgIFxuICAgIHJldHVybiBgJHtkYXRlS2V5fV8ke2NvbnRlbnRIYXNofWBcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9yZSB1bmlmaWVkIGluY2lkZW50cyB3aXRoIG11bHRpbGluZ3VhbCBjb250ZW50XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHN0b3JlVW5pZmllZEluY2lkZW50cyhcbiAgICBmZWVkQ29uZmlnOiBhbnksXG4gICAgbXVsdGlsaW5ndWFsSXRlbXM6IE1hcDxzdHJpbmcsIE11bHRpbGluZ3VhbENvbnRlbnQ+XG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGluY2lkZW50cyA9IFtdXG4gICAgXG4gICAgZm9yIChjb25zdCBba2V5LCBjb250ZW50XSBvZiBtdWx0aWxpbmd1YWxJdGVtcykge1xuICAgICAgLy8gR2V0IHByaW1hcnkgaXRlbSAocHJlZmVyIEVuZ2xpc2gpXG4gICAgICBjb25zdCBwcmltYXJ5SXRlbSA9IGNvbnRlbnQuZW4gfHwgY29udGVudFsnemgtVFcnXSB8fCBjb250ZW50Wyd6aC1DTiddXG4gICAgICBpZiAoIXByaW1hcnlJdGVtKSBjb250aW51ZVxuICAgICAgXG4gICAgICAvLyBHZW5lcmF0ZSBjb250ZW50IGhhc2ggZm9yIGRlZHVwbGljYXRpb25cbiAgICAgIGNvbnN0IGNvbnRlbnRIYXNoID0gdGhpcy5nZW5lcmF0ZUNvbnRlbnRIYXNoKGNvbnRlbnQpXG4gICAgICBcbiAgICAgIC8vIEJ1aWxkIG11bHRpbGluZ3VhbCBjb250ZW50IHN0cnVjdHVyZVxuICAgICAgY29uc3QgbXVsdGlsaW5ndWFsQ29udGVudDogYW55ID0ge31cbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBbbGFuZywgaXRlbV0gb2YgT2JqZWN0LmVudHJpZXMoY29udGVudCkpIHtcbiAgICAgICAgaWYgKGl0ZW0pIHtcbiAgICAgICAgICBtdWx0aWxpbmd1YWxDb250ZW50W2xhbmddID0ge1xuICAgICAgICAgICAgdGl0bGU6IGl0ZW0udGl0bGUsXG4gICAgICAgICAgICBib2R5OiBpdGVtLmJvZHksXG4gICAgICAgICAgICBsaW5rOiBpdGVtLmxpbmtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgaW5jaWRlbnRzLnB1c2goe1xuICAgICAgICBmZWVkX2lkOiBmZWVkQ29uZmlnLmlkLFxuICAgICAgICBzb3VyY2VfZ3VpZDogcHJpbWFyeUl0ZW0uZ3VpZCxcbiAgICAgICAgc291cmNlX3B1Ymxpc2hlZF9hdDogcHJpbWFyeUl0ZW0ucHViRGF0ZS50b0lTT1N0cmluZygpLFxuICAgICAgICBjb250ZW50OiBtdWx0aWxpbmd1YWxDb250ZW50LFxuICAgICAgICBjYXRlZ29yeTogJ2dvdicsXG4gICAgICAgIHNldmVyaXR5OiB0aGlzLmNhbGN1bGF0ZVNldmVyaXR5KHByaW1hcnlJdGVtKSxcbiAgICAgICAgcmVsZXZhbmNlX3Njb3JlOiB0aGlzLmNhbGN1bGF0ZVJlbGV2YW5jZShwcmltYXJ5SXRlbSksXG4gICAgICAgIGNvbnRlbnRfaGFzaDogY29udGVudEhhc2hcbiAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIC8vIEJhdGNoIHVwc2VydCBpbmNpZGVudHNcbiAgICBpZiAoaW5jaWRlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2luY2lkZW50c191bmlmaWVkJylcbiAgICAgICAgLnVwc2VydChpbmNpZGVudHMsIHtcbiAgICAgICAgICBvbkNvbmZsaWN0OiAnY29udGVudF9oYXNoJyxcbiAgICAgICAgICBpZ25vcmVEdXBsaWNhdGVzOiB0cnVlXG4gICAgICAgIH0pXG4gICAgICBcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBzdG9yaW5nIGluY2lkZW50cyBmb3IgJHtmZWVkQ29uZmlnLmJhc2Vfc2x1Z306YCwgZXJyb3IpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhgU3RvcmVkICR7aW5jaWRlbnRzLmxlbmd0aH0gdW5pZmllZCBpbmNpZGVudHMgZm9yICR7ZmVlZENvbmZpZy5iYXNlX3NsdWd9YClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHNldmVyaXR5IGJhc2VkIG9uIGNvbnRlbnQga2V5d29yZHNcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlU2V2ZXJpdHkoaXRlbTogVW5pZmllZEZlZWRJdGVtKTogbnVtYmVyIHtcbiAgICBjb25zdCBjb250ZW50ID0gYCR7aXRlbS50aXRsZX0gJHtpdGVtLmJvZHl9YC50b0xvd2VyQ2FzZSgpXG4gICAgXG4gICAgLy8gSGlnaCBzZXZlcml0eSBrZXl3b3Jkc1xuICAgIGlmIChjb250ZW50Lm1hdGNoKC91cmdlbnR8ZW1lcmdlbmN5fHNldmVyZXxjcml0aWNhbHxpbW1lZGlhdGV8bWFqb3IgZGlzcnVwdGlvbnxzdXNwZW5kZWQvKSkge1xuICAgICAgcmV0dXJuIDVcbiAgICB9XG4gICAgXG4gICAgLy8gTWVkaXVtLWhpZ2ggc2V2ZXJpdHlcbiAgICBpZiAoY29udGVudC5tYXRjaCgvZGlzcnVwdGlvbnxkZWxheWVkfGFmZmVjdGVkfGRpdmVydGVkfGNsb3NlZHxzdXNwZW5kZWQvKSkge1xuICAgICAgcmV0dXJuIDRcbiAgICB9XG4gICAgXG4gICAgLy8gTWVkaXVtIHNldmVyaXR5XG4gICAgaWYgKGNvbnRlbnQubWF0Y2goL3RlbXBvcmFyeXxyZWxvY2F0aW9ufHNwZWNpYWwgdHJhZmZpY3xhcnJhbmdlbWVudC8pKSB7XG4gICAgICByZXR1cm4gM1xuICAgIH1cbiAgICBcbiAgICAvLyBEZWZhdWx0XG4gICAgcmV0dXJuIDJcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgcmVsZXZhbmNlIHNjb3JlIGJhc2VkIG9uIGNvbnRlbnRcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlUmVsZXZhbmNlKGl0ZW06IFVuaWZpZWRGZWVkSXRlbSk6IG51bWJlciB7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKVxuICAgIGNvbnN0IGhvdXJzU2luY2VQdWJsaXNoZWQgPSAobm93LmdldFRpbWUoKSAtIGl0ZW0ucHViRGF0ZS5nZXRUaW1lKCkpIC8gKDEwMDAgKiA2MCAqIDYwKVxuICAgIFxuICAgIC8vIFRpbWUtYmFzZWQgZGVjYXlcbiAgICBsZXQgc2NvcmUgPSBNYXRoLm1heCgwLCAxIC0gKGhvdXJzU2luY2VQdWJsaXNoZWQgLyAxNjgpKSAvLyA3IGRheXMgZGVjYXlcbiAgICBcbiAgICAvLyBCb29zdCBmb3Igc2V2ZXJpdHkga2V5d29yZHNcbiAgICBjb25zdCBjb250ZW50ID0gYCR7aXRlbS50aXRsZX0gJHtpdGVtLmJvZHl9YC50b0xvd2VyQ2FzZSgpXG4gICAgaWYgKGNvbnRlbnQubWF0Y2goL3VyZ2VudHxlbWVyZ2VuY3l8c2V2ZXJlLykpIHtcbiAgICAgIHNjb3JlID0gTWF0aC5taW4oMSwgc2NvcmUgKyAwLjMpXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBNYXRoLnJvdW5kKHNjb3JlICogMTAwKSAvIDEwMFxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGNvbnRlbnQgaGFzaCBmb3IgZGVkdXBsaWNhdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZUNvbnRlbnRIYXNoKGNvbnRlbnQ6IE11bHRpbGluZ3VhbENvbnRlbnQpOiBzdHJpbmcge1xuICAgIGNvbnN0IGNvbWJpbmVkID0gT2JqZWN0LmVudHJpZXMoY29udGVudClcbiAgICAgIC5zb3J0KChbYV0sIFtiXSkgPT4gYS5sb2NhbGVDb21wYXJlKGIpKVxuICAgICAgLm1hcCgoW2xhbmcsIGl0ZW1dKSA9PiBgJHtsYW5nfToke2l0ZW0/LnRpdGxlfToke2l0ZW0/LmJvZHl9YClcbiAgICAgIC5qb2luKCd8JylcbiAgICBcbiAgICByZXR1cm4gY3JlYXRlSGFzaCgnc2hhMjU2JykudXBkYXRlKGNvbWJpbmVkKS5kaWdlc3QoJ2hleCcpXG4gIH1cblxuICAvKipcbiAgICogQ2xlYW4gdGV4dCBjb250ZW50XG4gICAqL1xuICBwcml2YXRlIGNsZWFuVGV4dCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGlmICghdGV4dCkgcmV0dXJuICcnXG4gICAgXG4gICAgcmV0dXJuIHRleHRcbiAgICAgIC5yZXBsYWNlKC88W14+XSo+L2csICcnKSAvLyBSZW1vdmUgSFRNTCB0YWdzXG4gICAgICAucmVwbGFjZSgvJm5ic3A7L2csICcgJylcbiAgICAgIC5yZXBsYWNlKC8mYW1wOy9nLCAnJicpXG4gICAgICAucmVwbGFjZSgvJmx0Oy9nLCAnPCcpXG4gICAgICAucmVwbGFjZSgvJmd0Oy9nLCAnPicpXG4gICAgICAucmVwbGFjZSgvJnF1b3Q7L2csICdcIicpXG4gICAgICAucmVwbGFjZSgvJiMwMzk7L2csIFwiJ1wiKVxuICAgICAgLnJlcGxhY2UoL1xccysvZywgJyAnKVxuICAgICAgLnRyaW0oKVxuICB9XG5cbiAgLyoqXG4gICAqIEdyb3VwIGZlZWRzIGJ5IGJhc2Ugc2x1Z1xuICAgKi9cbiAgcHJpdmF0ZSBncm91cEZlZWRzQnlCYXNlU2x1ZyhmZWVkczogYW55W10pOiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHtcbiAgICBjb25zdCBncm91cHM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fVxuICAgIFxuICAgIGZvciAoY29uc3QgZmVlZCBvZiBmZWVkcykge1xuICAgICAgZ3JvdXBzW2ZlZWQuYmFzZV9zbHVnXSA9IGZlZWRcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGdyb3Vwc1xuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2UgZ2V0dGVyXG5sZXQgaW5zdGFuY2U6IFVuaWZpZWRHb3Zlcm5tZW50RmVlZHMgfCBudWxsID0gbnVsbFxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VW5pZmllZEZlZWRzKCk6IFVuaWZpZWRHb3Zlcm5tZW50RmVlZHMge1xuICBpZiAoIWluc3RhbmNlKSB7XG4gICAgaW5zdGFuY2UgPSBuZXcgVW5pZmllZEdvdmVybm1lbnRGZWVkcygpXG4gIH1cbiAgcmV0dXJuIGluc3RhbmNlXG59Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsIlBhcnNlciIsImNyZWF0ZUhhc2giLCJ4bWwyanMiLCJVbmlmaWVkR292ZXJubWVudEZlZWRzIiwiY29uc3RydWN0b3IiLCJwYXJzZXIiLCJ0aW1lb3V0IiwiaGVhZGVycyIsImN1c3RvbUZpZWxkcyIsIml0ZW0iLCJ4bWxQYXJzZXIiLCJleHBsaWNpdEFycmF5IiwibWVyZ2VBdHRycyIsInN1cGFiYXNlIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJwcm9jZXNzQWxsRmVlZHMiLCJjb25zb2xlIiwibG9nIiwiZGF0YSIsImZlZWRzIiwiZXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJmZWVkR3JvdXBzIiwiZ3JvdXBGZWVkc0J5QmFzZVNsdWciLCJiYXNlU2x1ZyIsImZlZWRHcm91cCIsIk9iamVjdCIsImVudHJpZXMiLCJwcm9jZXNzRmVlZEdyb3VwIiwibXVsdGlsaW5ndWFsSXRlbXMiLCJNYXAiLCJsYW5nIiwidXJsIiwiZW4iLCJ1cmxfZW4iLCJ1cmxfemhfdHciLCJ1cmxfemhfY24iLCJpdGVtcyIsImZldGNoRmVlZCIsImtleSIsImdlbmVyYXRlSXRlbUtleSIsImhhcyIsInNldCIsImNvbnRlbnQiLCJnZXQiLCJ1cGRhdGVGaWVsZCIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsInVwZGF0ZSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImlkIiwic3RvcmVVbmlmaWVkSW5jaWRlbnRzIiwic3RhcnRzV2l0aCIsImZldGNoVHJhbnNwb3J0RGVwdEZlZWQiLCJmZWVkIiwicGFyc2VVUkwiLCJtYXAiLCJndWlkIiwibGluayIsInRpdGxlIiwiY2xlYW5UZXh0IiwiYm9keSIsImRlc2NyaXB0aW9uIiwicHViRGF0ZSIsIm5vdyIsInJlc3BvbnNlIiwiZmV0Y2giLCJ4bWwiLCJ0ZXh0IiwicmVzdWx0IiwicGFyc2VTdHJpbmdQcm9taXNlIiwibWVzc2FnZXMiLCJtZXNzYWdlIiwibXNnIiwiQXJyYXkiLCJpc0FycmF5IiwibXNnSWQiLCJtc2dJRCIsIm1zZ19pZCIsImlzc3VlRGF0ZSIsImlzc3VlX2RhdGUiLCJoZWFkaW5nIiwicHVzaCIsImRhdGVLZXkiLCJzcGxpdCIsImNvbnRlbnRIYXNoIiwic3Vic3RyaW5nIiwiZGlnZXN0IiwiZmVlZENvbmZpZyIsImluY2lkZW50cyIsInByaW1hcnlJdGVtIiwiZ2VuZXJhdGVDb250ZW50SGFzaCIsIm11bHRpbGluZ3VhbENvbnRlbnQiLCJmZWVkX2lkIiwic291cmNlX2d1aWQiLCJzb3VyY2VfcHVibGlzaGVkX2F0IiwiY2F0ZWdvcnkiLCJzZXZlcml0eSIsImNhbGN1bGF0ZVNldmVyaXR5IiwicmVsZXZhbmNlX3Njb3JlIiwiY2FsY3VsYXRlUmVsZXZhbmNlIiwiY29udGVudF9oYXNoIiwibGVuZ3RoIiwidXBzZXJ0Iiwib25Db25mbGljdCIsImlnbm9yZUR1cGxpY2F0ZXMiLCJiYXNlX3NsdWciLCJtYXRjaCIsImhvdXJzU2luY2VQdWJsaXNoZWQiLCJnZXRUaW1lIiwic2NvcmUiLCJNYXRoIiwibWF4IiwibWluIiwicm91bmQiLCJjb21iaW5lZCIsInNvcnQiLCJhIiwiYiIsImxvY2FsZUNvbXBhcmUiLCJqb2luIiwidHJpbSIsImdyb3VwcyIsImluc3RhbmNlIiwiZ2V0VW5pZmllZEZlZWRzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/government-feeds-unified.ts\n");

/***/ })

};
;