/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/topics/route";
exports.ids = ["app/api/topics/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "?32c4":
/*!****************************!*\
  !*** bufferutil (ignored) ***!
  \****************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?66e9":
/*!********************************!*\
  !*** utf-8-validate (ignored) ***!
  \********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftopics%2Froute&page=%2Fapi%2Ftopics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftopics%2Froute.ts&appDir=%2FUsers%2Fmarkau%2Fpanora8A%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmarkau%2Fpanora8A&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftopics%2Froute&page=%2Fapi%2Ftopics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftopics%2Froute.ts&appDir=%2FUsers%2Fmarkau%2Fpanora8A%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmarkau%2Fpanora8A&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_markau_panora8A_app_api_topics_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/topics/route.ts */ \"(rsc)/./app/api/topics/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/topics/route\",\n        pathname: \"/api/topics\",\n        filename: \"route\",\n        bundlePath: \"app/api/topics/route\"\n    },\n    resolvedPagePath: \"/Users/markau/panora8A/app/api/topics/route.ts\",\n    nextConfigOutput,\n    userland: _Users_markau_panora8A_app_api_topics_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/topics/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0b3BpY3MlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnRvcGljcyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnRvcGljcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm1hcmthdSUyRnBhbm9yYThBJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRm1hcmthdSUyRnBhbm9yYThBJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNGO0FBQzNFO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaGtpLXpvbmUvPzA5YWQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL21hcmthdS9wYW5vcmE4QS9hcHAvYXBpL3RvcGljcy9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdG9waWNzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdG9waWNzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS90b3BpY3Mvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvbWFya2F1L3Bhbm9yYThBL2FwcC9hcGkvdG9waWNzL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS90b3BpY3Mvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftopics%2Froute&page=%2Fapi%2Ftopics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftopics%2Froute.ts&appDir=%2FUsers%2Fmarkau%2Fpanora8A%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmarkau%2Fpanora8A&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/topics/route.ts":
/*!*********************************!*\
  !*** ./app/api/topics/route.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./lib/supabase.ts\");\n\n\nconst dynamic = \"force-dynamic\";\n// Helper function to add cache control headers\nfunction addCacheHeaders(response, articles = []) {\n    // Determine freshness based on latest article\n    const latestArticleTime = articles.length > 0 ? Math.max(...articles.map((a)=>new Date(a.publishedAt || a.created_at || 0).getTime())) : Date.now();\n    const lastModified = new Date(latestArticleTime).toUTCString();\n    const etag = `\"topics-${articles.length}-${latestArticleTime}\"`;\n    // No caching - articles update every minute, always serve fresh data\n    response.headers.set(\"Cache-Control\", \"no-cache, no-store, must-revalidate\");\n    response.headers.set(\"Last-Modified\", lastModified);\n    response.headers.set(\"ETag\", etag);\n    return response;\n}\n// Mock AI-enhanced articles as fallback\nconst mockAiArticles = [\n    {\n        id: \"ai-1\",\n        title: \"AI Revolution: How Machine Learning is Transforming Healthcare\",\n        summary: \"Artificial intelligence is revolutionizing healthcare with breakthrough applications in diagnosis, treatment planning, and drug discovery. Recent studies show AI can detect diseases earlier than traditional methods.\",\n        content: \"The healthcare industry is experiencing a paradigm shift as artificial intelligence technologies become increasingly sophisticated and accessible...\",\n        url: \"https://example.com/ai-healthcare\",\n        source: \"TechHealth Today\",\n        publishedAt: \"2024-01-15T10:30:00Z\",\n        imageUrl: \"/placeholder.svg?height=200&width=300\",\n        category: \"Technology\",\n        readTime: 5,\n        isAiEnhanced: true,\n        language: \"en\",\n        enhancementMetadata: {\n            searchQueries: [\n                \"AI in healthcare\",\n                \"machine learning medical diagnosis\"\n            ],\n            sources: [\n                {\n                    url: \"https://example.com/ai-medical-research\",\n                    title: \"Medical AI Research Study\",\n                    domain: \"research.example.com\",\n                    snippet: \"AI shows 95% accuracy in early disease detection\",\n                    accessedAt: \"2024-01-15T10:00:00Z\"\n                }\n            ],\n            relatedTopics: [\n                \"healthcare\",\n                \"artificial intelligence\",\n                \"medical technology\"\n            ],\n            enhancedAt: \"2024-01-15T10:30:00Z\"\n        }\n    },\n    {\n        id: \"ai-2\",\n        title: \"氣候變化：新的碳捕獲技術顯示希望\",\n        summary: \"科學家開發了一種革命性的碳捕獲系統，每年可以從大氣中清除數百萬噸二氧化碳。該技術使用先進材料高效地捕獲碳。\",\n        content: \"氣候變化研究實驗室出現了碳捕獲技術的突破，為應對氣候變化提供了新的希望...\",\n        url: \"https://example.com/carbon-capture-zh\",\n        source: \"環境科學週刊\",\n        publishedAt: \"2024-01-14T14:20:00Z\",\n        imageUrl: \"/placeholder.svg?height=200&width=300\",\n        category: \"Science\",\n        readTime: 4,\n        isAiEnhanced: true,\n        language: \"zh-CN\",\n        enhancementMetadata: {\n            searchQueries: [\n                \"碳捕獲技術\",\n                \"氣候變化解決方案\"\n            ],\n            sources: [\n                {\n                    url: \"https://example.com/carbon-tech-research\",\n                    title: \"碳捕獲技術研究\",\n                    domain: \"tech.example.com\",\n                    snippet: \"新技術可捕獲90%的工業排放\",\n                    accessedAt: \"2024-01-14T14:00:00Z\"\n                }\n            ],\n            relatedTopics: [\n                \"climate change\",\n                \"carbon capture\",\n                \"environmental technology\"\n            ],\n            enhancedAt: \"2024-01-14T14:20:00Z\"\n        }\n    },\n    {\n        id: \"ai-3\",\n        title: \"加密貨幣市場見證重大機構採用\",\n        summary: \"主要金融機構越來越多地採用加密貨幣解決方案，幾家銀行宣布新的數字資產服務。這標誌著傳統金融的重大轉變。\",\n        content: \"隨著傳統金融機構擁抱數字資產，加密貨幣格局正在迅速發展...\",\n        url: \"https://example.com/crypto-adoption-zh\",\n        source: \"金融時報\",\n        publishedAt: \"2024-01-13T09:15:00Z\",\n        imageUrl: \"/placeholder.svg?height=200&width=300\",\n        category: \"Finance\",\n        readTime: 3,\n        isAiEnhanced: true,\n        language: \"zh-TW\",\n        enhancementMetadata: {\n            searchQueries: [\n                \"加密貨幣機構採用\",\n                \"數字資產銀行\"\n            ],\n            sources: [\n                {\n                    url: \"https://example.com/crypto-banks\",\n                    title: \"銀行數字資產服務\",\n                    domain: \"finance.example.com\",\n                    snippet: \"70%的大型銀行計劃提供加密服務\",\n                    accessedAt: \"2024-01-13T09:00:00Z\"\n                }\n            ],\n            relatedTopics: [\n                \"cryptocurrency\",\n                \"financial institutions\",\n                \"digital assets\"\n            ],\n            enhancedAt: \"2024-01-13T09:15:00Z\"\n        }\n    }\n];\nasync function GET(request) {\n    try {\n        const searchParams = request.nextUrl.searchParams;\n        const page = Number.parseInt(searchParams.get(\"page\") || \"0\");\n        const language = searchParams.get(\"language\") || \"en\";\n        const limit = 10;\n        console.log(`Topics API called for language: ${language}, page: ${page}`);\n        // Check if database is set up\n        const isDatabaseReady = await (0,_lib_supabase__WEBPACK_IMPORTED_MODULE_1__.checkDatabaseSetup)();\n        console.log(\"Database ready status:\", isDatabaseReady);\n        if (!isDatabaseReady) {\n            console.warn(\"Database not set up, using mock AI-enhanced articles\");\n            // Filter mock articles by language\n            const filteredMockArticles = mockAiArticles.filter((article)=>article.language === language);\n            const startIndex = page * limit;\n            const endIndex = startIndex + limit;\n            const paginatedArticles = filteredMockArticles.slice(startIndex, endIndex);\n            const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                articles: paginatedArticles,\n                nextPage: endIndex < filteredMockArticles.length ? page + 1 : null,\n                usingMockData: true,\n                debug: \"Database setup check failed\"\n            });\n            return addCacheHeaders(response, paginatedArticles);\n        }\n        console.log(\"Fetching AI-enhanced articles from database...\");\n        // Build a more sophisticated query that checks both language field and metadata language\n        try {\n            let query = _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"articles\").select(\"*\").eq(\"is_ai_enhanced\", true).is(\"deleted_at\", null).order(\"created_at\", {\n                ascending: false\n            });\n            // CRITICAL FIX: Exclude source articles that have enhanced versions\n            // Only show articles that either:\n            // 1. Have an original_article_id (are enhanced versions), OR\n            // 2. Don't have any enhanced versions pointing to them (standalone enhanced articles)\n            // For now, prioritize articles with original_article_id (properly linked enhanced articles)\n            // This will exclude the source articles that are incorrectly marked as enhanced\n            query = query.not(\"original_article_id\", \"is\", null);\n            // Filter by language using only metadata (since language column doesn't exist)\n            if (language && language !== \"en\") {\n                // For non-English languages, check metadata language\n                query = query.eq(\"enhancement_metadata->>language\", language);\n            } else {\n                // For English, include articles marked as English OR with null/missing metadata\n                // This catches new articles that haven't been fully processed yet\n                query = query.or(`enhancement_metadata->>language.eq.en,enhancement_metadata->>language.is.null,enhancement_metadata.is.null`);\n            }\n            const { data: articles, error } = await query.range(page * limit, (page + 1) * limit - 1);\n            if (error) {\n                console.error(\"Database query error:\", error);\n                throw error;\n            }\n            console.log(`Fetched ${articles?.length || 0} AI-enhanced articles from database`);\n            // If we got articles, continue with processing\n            if (articles && articles.length > 0) {\n                // Transform to match frontend interface\n                const transformedArticles = articles.map((article)=>({\n                        id: article.id,\n                        title: article.title,\n                        summary: article.ai_summary || article.summary,\n                        content: article.content,\n                        url: article.url,\n                        source: article.source,\n                        publishedAt: article.published_at || article.created_at,\n                        imageUrl: article.image_url || \"/placeholder.svg?height=200&width=300\",\n                        category: article.category || \"General\",\n                        readTime: Math.ceil((article.content?.length || 0) / 200) || 3,\n                        isAiEnhanced: article.is_ai_enhanced || false,\n                        language: article.enhancement_metadata?.language || language,\n                        originalArticleId: article.original_article_id,\n                        enhancementMetadata: article.enhancement_metadata\n                    }));\n                console.log(\"Returning real AI-enhanced articles from database\");\n                console.log(\"Article IDs being returned:\", transformedArticles.map((a)=>a.id));\n                const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    articles: transformedArticles,\n                    nextPage: transformedArticles.length === limit ? page + 1 : null,\n                    usingMockData: false,\n                    debug: \"Using real database data\"\n                });\n                return addCacheHeaders(response, transformedArticles);\n            }\n        } catch (queryError) {\n            console.error(\"Database query failed:\", queryError);\n        // Fall through to mock data fallback\n        }\n        // If no AI-enhanced articles in database, fall back to mock data\n        console.warn(\"No AI-enhanced articles in database, using mock data\");\n        const filteredMockArticles = mockAiArticles.filter((article)=>article.language === language);\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            articles: filteredMockArticles.slice(0, limit),\n            nextPage: null,\n            usingMockData: true,\n            debug: \"No AI-enhanced articles found in database\"\n        });\n        return addCacheHeaders(response, filteredMockArticles.slice(0, limit));\n    } catch (error) {\n        console.error(\"Error fetching AI-enhanced articles:\", error);\n        // Return mock data as fallback\n        const searchParams = request.nextUrl.searchParams;\n        const page = Number.parseInt(searchParams.get(\"page\") || \"0\");\n        const language = searchParams.get(\"language\") || \"en\";\n        const limit = 10;\n        const filteredMockArticles = mockAiArticles.filter((article)=>article.language === language);\n        const startIndex = page * limit;\n        const endIndex = startIndex + limit;\n        const paginatedArticles = filteredMockArticles.slice(startIndex, endIndex);\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            articles: paginatedArticles,\n            nextPage: endIndex < filteredMockArticles.length ? page + 1 : null,\n            usingMockData: true,\n            error: \"Database connection failed, using mock data\",\n            debug: error instanceof Error ? error.message : \"Unknown error\"\n        });\n        return addCacheHeaders(response, paginatedArticles);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0osYUFBYUssR0FBRyxDQUFDLFdBQVc7UUFDekQsTUFBTWhCLFdBQVdXLGFBQWFLLEdBQUcsQ0FBQyxlQUFlO1FBQ2pELE1BQU1DLFFBQVE7UUFFZCxNQUFNSyx1QkFBdUJqQyxlQUFla0MsTUFBTSxDQUFDQyxDQUFBQSxVQUNqREEsUUFBUXhCLFFBQVEsS0FBS0E7UUFHdkIsTUFBTXlCLGFBQWFaLE9BQU9JO1FBQzFCLE1BQU1TLFdBQVdELGFBQWFSO1FBQzlCLE1BQU1VLG9CQUFvQkwscUJBQXFCTSxLQUFLLENBQUNILFlBQVlDO1FBRWpFLE1BQU12RCxXQUFXTCxxREFBWUEsQ0FBQytELElBQUksQ0FBQztZQUNqQ3pELFVBQVV1RDtZQUNWRyxVQUFVSixXQUFXSixxQkFBcUJoRCxNQUFNLEdBQUd1QyxPQUFPLElBQUk7WUFDOURrQixlQUFlO1lBQ2ZZLE9BQU87WUFDUFgsT0FBT1csaUJBQWlCWSxRQUFRWixNQUFNYSxPQUFPLEdBQUc7UUFDbEQ7UUFFQSxPQUFPdEYsZ0JBQWdCQyxVQUFVd0Q7SUFDbkM7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2hraS16b25lLy4vYXBwL2FwaS90b3BpY3Mvcm91dGUudHM/YTZjNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0eXBlIE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIlxuaW1wb3J0IHsgZ2V0QXJ0aWNsZXMsIGNoZWNrRGF0YWJhc2VTZXR1cCwgc3VwYWJhc2UgfSBmcm9tIFwiQC9saWIvc3VwYWJhc2VcIlxuXG5leHBvcnQgY29uc3QgZHluYW1pYyA9ICdmb3JjZS1keW5hbWljJ1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gYWRkIGNhY2hlIGNvbnRyb2wgaGVhZGVyc1xuZnVuY3Rpb24gYWRkQ2FjaGVIZWFkZXJzKHJlc3BvbnNlOiBOZXh0UmVzcG9uc2UsIGFydGljbGVzOiBhbnlbXSA9IFtdKSB7XG4gIC8vIERldGVybWluZSBmcmVzaG5lc3MgYmFzZWQgb24gbGF0ZXN0IGFydGljbGVcbiAgY29uc3QgbGF0ZXN0QXJ0aWNsZVRpbWUgPSBhcnRpY2xlcy5sZW5ndGggPiAwIFxuICAgID8gTWF0aC5tYXgoLi4uYXJ0aWNsZXMubWFwKGEgPT4gbmV3IERhdGUoYS5wdWJsaXNoZWRBdCB8fCBhLmNyZWF0ZWRfYXQgfHwgMCkuZ2V0VGltZSgpKSlcbiAgICA6IERhdGUubm93KClcbiAgXG4gIGNvbnN0IGxhc3RNb2RpZmllZCA9IG5ldyBEYXRlKGxhdGVzdEFydGljbGVUaW1lKS50b1VUQ1N0cmluZygpXG4gIGNvbnN0IGV0YWcgPSBgXCJ0b3BpY3MtJHthcnRpY2xlcy5sZW5ndGh9LSR7bGF0ZXN0QXJ0aWNsZVRpbWV9XCJgXG4gIFxuICAvLyBObyBjYWNoaW5nIC0gYXJ0aWNsZXMgdXBkYXRlIGV2ZXJ5IG1pbnV0ZSwgYWx3YXlzIHNlcnZlIGZyZXNoIGRhdGFcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCAnbm8tY2FjaGUsIG5vLXN0b3JlLCBtdXN0LXJldmFsaWRhdGUnKVxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnTGFzdC1Nb2RpZmllZCcsIGxhc3RNb2RpZmllZClcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0VUYWcnLCBldGFnKVxuICBcbiAgcmV0dXJuIHJlc3BvbnNlXG59XG5cbi8vIE1vY2sgQUktZW5oYW5jZWQgYXJ0aWNsZXMgYXMgZmFsbGJhY2tcbmNvbnN0IG1vY2tBaUFydGljbGVzID0gW1xuICB7XG4gICAgaWQ6IFwiYWktMVwiLFxuICAgIHRpdGxlOiBcIkFJIFJldm9sdXRpb246IEhvdyBNYWNoaW5lIExlYXJuaW5nIGlzIFRyYW5zZm9ybWluZyBIZWFsdGhjYXJlXCIsXG4gICAgc3VtbWFyeTogXCJBcnRpZmljaWFsIGludGVsbGlnZW5jZSBpcyByZXZvbHV0aW9uaXppbmcgaGVhbHRoY2FyZSB3aXRoIGJyZWFrdGhyb3VnaCBhcHBsaWNhdGlvbnMgaW4gZGlhZ25vc2lzLCB0cmVhdG1lbnQgcGxhbm5pbmcsIGFuZCBkcnVnIGRpc2NvdmVyeS4gUmVjZW50IHN0dWRpZXMgc2hvdyBBSSBjYW4gZGV0ZWN0IGRpc2Vhc2VzIGVhcmxpZXIgdGhhbiB0cmFkaXRpb25hbCBtZXRob2RzLlwiLFxuICAgIGNvbnRlbnQ6IFwiVGhlIGhlYWx0aGNhcmUgaW5kdXN0cnkgaXMgZXhwZXJpZW5jaW5nIGEgcGFyYWRpZ20gc2hpZnQgYXMgYXJ0aWZpY2lhbCBpbnRlbGxpZ2VuY2UgdGVjaG5vbG9naWVzIGJlY29tZSBpbmNyZWFzaW5nbHkgc29waGlzdGljYXRlZCBhbmQgYWNjZXNzaWJsZS4uLlwiLFxuICAgIHVybDogXCJodHRwczovL2V4YW1wbGUuY29tL2FpLWhlYWx0aGNhcmVcIixcbiAgICBzb3VyY2U6IFwiVGVjaEhlYWx0aCBUb2RheVwiLFxuICAgIHB1Ymxpc2hlZEF0OiBcIjIwMjQtMDEtMTVUMTA6MzA6MDBaXCIsXG4gICAgaW1hZ2VVcmw6IFwiL3BsYWNlaG9sZGVyLnN2Zz9oZWlnaHQ9MjAwJndpZHRoPTMwMFwiLFxuICAgIGNhdGVnb3J5OiBcIlRlY2hub2xvZ3lcIixcbiAgICByZWFkVGltZTogNSxcbiAgICBpc0FpRW5oYW5jZWQ6IHRydWUsXG4gICAgbGFuZ3VhZ2U6IFwiZW5cIixcbiAgICBlbmhhbmNlbWVudE1ldGFkYXRhOiB7XG4gICAgICBzZWFyY2hRdWVyaWVzOiBbXCJBSSBpbiBoZWFsdGhjYXJlXCIsIFwibWFjaGluZSBsZWFybmluZyBtZWRpY2FsIGRpYWdub3Npc1wiXSxcbiAgICAgIHNvdXJjZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHVybDogXCJodHRwczovL2V4YW1wbGUuY29tL2FpLW1lZGljYWwtcmVzZWFyY2hcIixcbiAgICAgICAgICB0aXRsZTogXCJNZWRpY2FsIEFJIFJlc2VhcmNoIFN0dWR5XCIsXG4gICAgICAgICAgZG9tYWluOiBcInJlc2VhcmNoLmV4YW1wbGUuY29tXCIsXG4gICAgICAgICAgc25pcHBldDogXCJBSSBzaG93cyA5NSUgYWNjdXJhY3kgaW4gZWFybHkgZGlzZWFzZSBkZXRlY3Rpb25cIixcbiAgICAgICAgICBhY2Nlc3NlZEF0OiBcIjIwMjQtMDEtMTVUMTA6MDA6MDBaXCJcbiAgICAgICAgfVxuICAgICAgXSxcbiAgICAgIHJlbGF0ZWRUb3BpY3M6IFtcImhlYWx0aGNhcmVcIiwgXCJhcnRpZmljaWFsIGludGVsbGlnZW5jZVwiLCBcIm1lZGljYWwgdGVjaG5vbG9neVwiXSxcbiAgICAgIGVuaGFuY2VkQXQ6IFwiMjAyNC0wMS0xNVQxMDozMDowMFpcIlxuICAgIH1cbiAgfSxcbiAge1xuICAgIGlkOiBcImFpLTJcIixcbiAgICB0aXRsZTogXCLmsKPlgJnororljJbvvJrmlrDnmoTnorPmjZXnjbLmioDooZPpoa/npLrluIzmnJtcIixcbiAgICBzdW1tYXJ5OiBcIuenkeWtuOWutumWi+eZvOS6huS4gOeorumdqeWRveaAp+eahOeis+aNleeNsuezu+e1se+8jOavj+W5tOWPr+S7peW+nuWkp+awo+S4rea4hemZpOaVuOeZvuiQrOWZuOS6jOawp+WMlueis+OAguipsuaKgOihk+S9v+eUqOWFiOmAsuadkOaWmemrmOaViOWcsOaNleeNsueis+OAglwiLFxuICAgIGNvbnRlbnQ6IFwi5rCj5YCZ6K6K5YyW56CU56m25a+m6amX5a6k5Ye654++5LqG56Kz5o2V542y5oqA6KGT55qE56qB56C077yM54K65oeJ5bCN5rCj5YCZ6K6K5YyW5o+Q5L6b5LqG5paw55qE5biM5pybLi4uXCIsXG4gICAgdXJsOiBcImh0dHBzOi8vZXhhbXBsZS5jb20vY2FyYm9uLWNhcHR1cmUtemhcIixcbiAgICBzb3VyY2U6IFwi55Kw5aKD56eR5a246YCx5YiKXCIsXG4gICAgcHVibGlzaGVkQXQ6IFwiMjAyNC0wMS0xNFQxNDoyMDowMFpcIixcbiAgICBpbWFnZVVybDogXCIvcGxhY2Vob2xkZXIuc3ZnP2hlaWdodD0yMDAmd2lkdGg9MzAwXCIsXG4gICAgY2F0ZWdvcnk6IFwiU2NpZW5jZVwiLFxuICAgIHJlYWRUaW1lOiA0LFxuICAgIGlzQWlFbmhhbmNlZDogdHJ1ZSxcbiAgICBsYW5ndWFnZTogXCJ6aC1DTlwiLFxuICAgIGVuaGFuY2VtZW50TWV0YWRhdGE6IHtcbiAgICAgIHNlYXJjaFF1ZXJpZXM6IFtcIueis+aNleeNsuaKgOihk1wiLCBcIuawo+WAmeiuiuWMluino+axuuaWueahiFwiXSxcbiAgICAgIHNvdXJjZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHVybDogXCJodHRwczovL2V4YW1wbGUuY29tL2NhcmJvbi10ZWNoLXJlc2VhcmNoXCIsXG4gICAgICAgICAgdGl0bGU6IFwi56Kz5o2V542y5oqA6KGT56CU56m2XCIsXG4gICAgICAgICAgZG9tYWluOiBcInRlY2guZXhhbXBsZS5jb21cIixcbiAgICAgICAgICBzbmlwcGV0OiBcIuaWsOaKgOihk+WPr+aNleeNsjkwJeeahOW3pealreaOkuaUvlwiLFxuICAgICAgICAgIGFjY2Vzc2VkQXQ6IFwiMjAyNC0wMS0xNFQxNDowMDowMFpcIlxuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgcmVsYXRlZFRvcGljczogW1wiY2xpbWF0ZSBjaGFuZ2VcIiwgXCJjYXJib24gY2FwdHVyZVwiLCBcImVudmlyb25tZW50YWwgdGVjaG5vbG9neVwiXSxcbiAgICAgIGVuaGFuY2VkQXQ6IFwiMjAyNC0wMS0xNFQxNDoyMDowMFpcIlxuICAgIH1cbiAgfSxcbiAge1xuICAgIGlkOiBcImFpLTNcIixcbiAgICB0aXRsZTogXCLliqDlr4bosqjluaPluILloLTopovorYnph43lpKfmqZ/mp4vmjqHnlKhcIixcbiAgICBzdW1tYXJ5OiBcIuS4u+imgemHkeiejeapn+ani+i2iuS+hui2iuWkmuWcsOaOoeeUqOWKoOWvhuiyqOW5o+ino+axuuaWueahiO+8jOW5vuWutumKgOihjOWuo+W4g+aWsOeahOaVuOWtl+izh+eUouacjeWLmeOAgumAmeaomeiqjOiRl+WCs+e1semHkeiejeeahOmHjeWkp+i9ieiuiuOAglwiLFxuICAgIGNvbnRlbnQ6IFwi6Zqo6JGX5YKz57Wx6YeR6J6N5qmf5qeL5pOB5oqx5pW45a2X6LOH55Si77yM5Yqg5a+G6LKo5bmj5qC85bGA5q2j5Zyo6L+F6YCf55m85bGVLi4uXCIsXG4gICAgdXJsOiBcImh0dHBzOi8vZXhhbXBsZS5jb20vY3J5cHRvLWFkb3B0aW9uLXpoXCIsXG4gICAgc291cmNlOiBcIumHkeiejeaZguWgsVwiLFxuICAgIHB1Ymxpc2hlZEF0OiBcIjIwMjQtMDEtMTNUMDk6MTU6MDBaXCIsXG4gICAgaW1hZ2VVcmw6IFwiL3BsYWNlaG9sZGVyLnN2Zz9oZWlnaHQ9MjAwJndpZHRoPTMwMFwiLFxuICAgIGNhdGVnb3J5OiBcIkZpbmFuY2VcIixcbiAgICByZWFkVGltZTogMyxcbiAgICBpc0FpRW5oYW5jZWQ6IHRydWUsXG4gICAgbGFuZ3VhZ2U6IFwiemgtVFdcIixcbiAgICBlbmhhbmNlbWVudE1ldGFkYXRhOiB7XG4gICAgICBzZWFyY2hRdWVyaWVzOiBbXCLliqDlr4bosqjluaPmqZ/mp4vmjqHnlKhcIiwgXCLmlbjlrZfos4fnlKLpioDooYxcIl0sXG4gICAgICBzb3VyY2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9leGFtcGxlLmNvbS9jcnlwdG8tYmFua3NcIixcbiAgICAgICAgICB0aXRsZTogXCLpioDooYzmlbjlrZfos4fnlKLmnI3li5lcIixcbiAgICAgICAgICBkb21haW46IFwiZmluYW5jZS5leGFtcGxlLmNvbVwiLFxuICAgICAgICAgIHNuaXBwZXQ6IFwiNzAl55qE5aSn5Z6L6YqA6KGM6KiI5YqD5o+Q5L6b5Yqg5a+G5pyN5YuZXCIsXG4gICAgICAgICAgYWNjZXNzZWRBdDogXCIyMDI0LTAxLTEzVDA5OjAwOjAwWlwiXG4gICAgICAgIH1cbiAgICAgIF0sXG4gICAgICByZWxhdGVkVG9waWNzOiBbXCJjcnlwdG9jdXJyZW5jeVwiLCBcImZpbmFuY2lhbCBpbnN0aXR1dGlvbnNcIiwgXCJkaWdpdGFsIGFzc2V0c1wiXSxcbiAgICAgIGVuaGFuY2VkQXQ6IFwiMjAyNC0wMS0xM1QwOToxNTowMFpcIlxuICAgIH1cbiAgfSxcbl1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IHJlcXVlc3QubmV4dFVybC5zZWFyY2hQYXJhbXNcbiAgICBjb25zdCBwYWdlID0gTnVtYmVyLnBhcnNlSW50KHNlYXJjaFBhcmFtcy5nZXQoXCJwYWdlXCIpIHx8IFwiMFwiKVxuICAgIGNvbnN0IGxhbmd1YWdlID0gc2VhcmNoUGFyYW1zLmdldChcImxhbmd1YWdlXCIpIHx8IFwiZW5cIlxuICAgIGNvbnN0IGxpbWl0ID0gMTBcblxuICAgIGNvbnNvbGUubG9nKGBUb3BpY3MgQVBJIGNhbGxlZCBmb3IgbGFuZ3VhZ2U6ICR7bGFuZ3VhZ2V9LCBwYWdlOiAke3BhZ2V9YClcblxuICAgIC8vIENoZWNrIGlmIGRhdGFiYXNlIGlzIHNldCB1cFxuICAgIGNvbnN0IGlzRGF0YWJhc2VSZWFkeSA9IGF3YWl0IGNoZWNrRGF0YWJhc2VTZXR1cCgpXG4gICAgY29uc29sZS5sb2coXCJEYXRhYmFzZSByZWFkeSBzdGF0dXM6XCIsIGlzRGF0YWJhc2VSZWFkeSlcblxuICAgIGlmICghaXNEYXRhYmFzZVJlYWR5KSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJEYXRhYmFzZSBub3Qgc2V0IHVwLCB1c2luZyBtb2NrIEFJLWVuaGFuY2VkIGFydGljbGVzXCIpXG4gICAgICAvLyBGaWx0ZXIgbW9jayBhcnRpY2xlcyBieSBsYW5ndWFnZVxuICAgICAgY29uc3QgZmlsdGVyZWRNb2NrQXJ0aWNsZXMgPSBtb2NrQWlBcnRpY2xlcy5maWx0ZXIoYXJ0aWNsZSA9PiBcbiAgICAgICAgYXJ0aWNsZS5sYW5ndWFnZSA9PT0gbGFuZ3VhZ2VcbiAgICAgIClcbiAgICAgIFxuICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IHBhZ2UgKiBsaW1pdFxuICAgICAgY29uc3QgZW5kSW5kZXggPSBzdGFydEluZGV4ICsgbGltaXRcbiAgICAgIGNvbnN0IHBhZ2luYXRlZEFydGljbGVzID0gZmlsdGVyZWRNb2NrQXJ0aWNsZXMuc2xpY2Uoc3RhcnRJbmRleCwgZW5kSW5kZXgpXG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBhcnRpY2xlczogcGFnaW5hdGVkQXJ0aWNsZXMsXG4gICAgICAgIG5leHRQYWdlOiBlbmRJbmRleCA8IGZpbHRlcmVkTW9ja0FydGljbGVzLmxlbmd0aCA/IHBhZ2UgKyAxIDogbnVsbCxcbiAgICAgICAgdXNpbmdNb2NrRGF0YTogdHJ1ZSxcbiAgICAgICAgZGVidWc6IFwiRGF0YWJhc2Ugc2V0dXAgY2hlY2sgZmFpbGVkXCIsXG4gICAgICB9KVxuICAgICAgXG4gICAgICByZXR1cm4gYWRkQ2FjaGVIZWFkZXJzKHJlc3BvbnNlLCBwYWdpbmF0ZWRBcnRpY2xlcylcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcIkZldGNoaW5nIEFJLWVuaGFuY2VkIGFydGljbGVzIGZyb20gZGF0YWJhc2UuLi5cIilcbiAgICBcbiAgICAvLyBCdWlsZCBhIG1vcmUgc29waGlzdGljYXRlZCBxdWVyeSB0aGF0IGNoZWNrcyBib3RoIGxhbmd1YWdlIGZpZWxkIGFuZCBtZXRhZGF0YSBsYW5ndWFnZVxuICAgIHRyeSB7XG4gICAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZVxuICAgICAgICAuZnJvbShcImFydGljbGVzXCIpXG4gICAgICAgIC5zZWxlY3QoXCIqXCIpXG4gICAgICAgIC5lcSgnaXNfYWlfZW5oYW5jZWQnLCB0cnVlKVxuICAgICAgICAuaXMoJ2RlbGV0ZWRfYXQnLCBudWxsKVxuICAgICAgICAub3JkZXIoXCJjcmVhdGVkX2F0XCIsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgICAgXG4gICAgICAvLyBDUklUSUNBTCBGSVg6IEV4Y2x1ZGUgc291cmNlIGFydGljbGVzIHRoYXQgaGF2ZSBlbmhhbmNlZCB2ZXJzaW9uc1xuICAgICAgLy8gT25seSBzaG93IGFydGljbGVzIHRoYXQgZWl0aGVyOlxuICAgICAgLy8gMS4gSGF2ZSBhbiBvcmlnaW5hbF9hcnRpY2xlX2lkIChhcmUgZW5oYW5jZWQgdmVyc2lvbnMpLCBPUlxuICAgICAgLy8gMi4gRG9uJ3QgaGF2ZSBhbnkgZW5oYW5jZWQgdmVyc2lvbnMgcG9pbnRpbmcgdG8gdGhlbSAoc3RhbmRhbG9uZSBlbmhhbmNlZCBhcnRpY2xlcylcbiAgICAgIFxuICAgICAgLy8gRm9yIG5vdywgcHJpb3JpdGl6ZSBhcnRpY2xlcyB3aXRoIG9yaWdpbmFsX2FydGljbGVfaWQgKHByb3Blcmx5IGxpbmtlZCBlbmhhbmNlZCBhcnRpY2xlcylcbiAgICAgIC8vIFRoaXMgd2lsbCBleGNsdWRlIHRoZSBzb3VyY2UgYXJ0aWNsZXMgdGhhdCBhcmUgaW5jb3JyZWN0bHkgbWFya2VkIGFzIGVuaGFuY2VkXG4gICAgICBxdWVyeSA9IHF1ZXJ5Lm5vdCgnb3JpZ2luYWxfYXJ0aWNsZV9pZCcsICdpcycsIG51bGwpXG4gICAgICBcbiAgICAgIC8vIEZpbHRlciBieSBsYW5ndWFnZSB1c2luZyBvbmx5IG1ldGFkYXRhIChzaW5jZSBsYW5ndWFnZSBjb2x1bW4gZG9lc24ndCBleGlzdClcbiAgICAgIGlmIChsYW5ndWFnZSAmJiBsYW5ndWFnZSAhPT0gXCJlblwiKSB7XG4gICAgICAgIC8vIEZvciBub24tRW5nbGlzaCBsYW5ndWFnZXMsIGNoZWNrIG1ldGFkYXRhIGxhbmd1YWdlXG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2VuaGFuY2VtZW50X21ldGFkYXRhLT4+bGFuZ3VhZ2UnLCBsYW5ndWFnZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZvciBFbmdsaXNoLCBpbmNsdWRlIGFydGljbGVzIG1hcmtlZCBhcyBFbmdsaXNoIE9SIHdpdGggbnVsbC9taXNzaW5nIG1ldGFkYXRhXG4gICAgICAgIC8vIFRoaXMgY2F0Y2hlcyBuZXcgYXJ0aWNsZXMgdGhhdCBoYXZlbid0IGJlZW4gZnVsbHkgcHJvY2Vzc2VkIHlldFxuICAgICAgICBxdWVyeSA9IHF1ZXJ5Lm9yKGBlbmhhbmNlbWVudF9tZXRhZGF0YS0+Pmxhbmd1YWdlLmVxLmVuLGVuaGFuY2VtZW50X21ldGFkYXRhLT4+bGFuZ3VhZ2UuaXMubnVsbCxlbmhhbmNlbWVudF9tZXRhZGF0YS5pcy5udWxsYClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyBkYXRhOiBhcnRpY2xlcywgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5LnJhbmdlKHBhZ2UgKiBsaW1pdCwgKHBhZ2UgKyAxKSAqIGxpbWl0IC0gMSlcbiAgICAgIFxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJEYXRhYmFzZSBxdWVyeSBlcnJvcjpcIiwgZXJyb3IpXG4gICAgICAgIHRocm93IGVycm9yXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGBGZXRjaGVkICR7YXJ0aWNsZXM/Lmxlbmd0aCB8fCAwfSBBSS1lbmhhbmNlZCBhcnRpY2xlcyBmcm9tIGRhdGFiYXNlYClcbiAgICAgIFxuICAgICAgLy8gSWYgd2UgZ290IGFydGljbGVzLCBjb250aW51ZSB3aXRoIHByb2Nlc3NpbmdcbiAgICAgIGlmIChhcnRpY2xlcyAmJiBhcnRpY2xlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIFRyYW5zZm9ybSB0byBtYXRjaCBmcm9udGVuZCBpbnRlcmZhY2VcbiAgICAgICAgY29uc3QgdHJhbnNmb3JtZWRBcnRpY2xlcyA9IGFydGljbGVzLm1hcCgoYXJ0aWNsZSkgPT4gKHtcbiAgICAgICAgICBpZDogYXJ0aWNsZS5pZCxcbiAgICAgICAgICB0aXRsZTogYXJ0aWNsZS50aXRsZSxcbiAgICAgICAgICBzdW1tYXJ5OiBhcnRpY2xlLmFpX3N1bW1hcnkgfHwgYXJ0aWNsZS5zdW1tYXJ5LFxuICAgICAgICAgIGNvbnRlbnQ6IGFydGljbGUuY29udGVudCxcbiAgICAgICAgICB1cmw6IGFydGljbGUudXJsLFxuICAgICAgICAgIHNvdXJjZTogYXJ0aWNsZS5zb3VyY2UsXG4gICAgICAgICAgcHVibGlzaGVkQXQ6IGFydGljbGUucHVibGlzaGVkX2F0IHx8IGFydGljbGUuY3JlYXRlZF9hdCxcbiAgICAgICAgICBpbWFnZVVybDogYXJ0aWNsZS5pbWFnZV91cmwgfHwgXCIvcGxhY2Vob2xkZXIuc3ZnP2hlaWdodD0yMDAmd2lkdGg9MzAwXCIsXG4gICAgICAgICAgY2F0ZWdvcnk6IGFydGljbGUuY2F0ZWdvcnkgfHwgXCJHZW5lcmFsXCIsXG4gICAgICAgICAgcmVhZFRpbWU6IE1hdGguY2VpbCgoYXJ0aWNsZS5jb250ZW50Py5sZW5ndGggfHwgMCkgLyAyMDApIHx8IDMsXG4gICAgICAgICAgaXNBaUVuaGFuY2VkOiBhcnRpY2xlLmlzX2FpX2VuaGFuY2VkIHx8IGZhbHNlLFxuICAgICAgICAgIGxhbmd1YWdlOiBhcnRpY2xlLmVuaGFuY2VtZW50X21ldGFkYXRhPy5sYW5ndWFnZSB8fCBsYW5ndWFnZSxcbiAgICAgICAgICBvcmlnaW5hbEFydGljbGVJZDogYXJ0aWNsZS5vcmlnaW5hbF9hcnRpY2xlX2lkLFxuICAgICAgICAgIGVuaGFuY2VtZW50TWV0YWRhdGE6IGFydGljbGUuZW5oYW5jZW1lbnRfbWV0YWRhdGFcbiAgICAgICAgfSkpXG5cbiAgICAgICAgY29uc29sZS5sb2coXCJSZXR1cm5pbmcgcmVhbCBBSS1lbmhhbmNlZCBhcnRpY2xlcyBmcm9tIGRhdGFiYXNlXCIpXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQXJ0aWNsZSBJRHMgYmVpbmcgcmV0dXJuZWQ6XCIsIHRyYW5zZm9ybWVkQXJ0aWNsZXMubWFwKGEgPT4gYS5pZCkpXG4gICAgICAgIFxuICAgICAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICBhcnRpY2xlczogdHJhbnNmb3JtZWRBcnRpY2xlcyxcbiAgICAgICAgICBuZXh0UGFnZTogdHJhbnNmb3JtZWRBcnRpY2xlcy5sZW5ndGggPT09IGxpbWl0ID8gcGFnZSArIDEgOiBudWxsLFxuICAgICAgICAgIHVzaW5nTW9ja0RhdGE6IGZhbHNlLFxuICAgICAgICAgIGRlYnVnOiBcIlVzaW5nIHJlYWwgZGF0YWJhc2UgZGF0YVwiLFxuICAgICAgICB9KVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGFkZENhY2hlSGVhZGVycyhyZXNwb25zZSwgdHJhbnNmb3JtZWRBcnRpY2xlcylcbiAgICAgIH1cbiAgICB9IGNhdGNoIChxdWVyeUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRGF0YWJhc2UgcXVlcnkgZmFpbGVkOlwiLCBxdWVyeUVycm9yKVxuICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIG1vY2sgZGF0YSBmYWxsYmFja1xuICAgIH1cblxuICAgIC8vIElmIG5vIEFJLWVuaGFuY2VkIGFydGljbGVzIGluIGRhdGFiYXNlLCBmYWxsIGJhY2sgdG8gbW9jayBkYXRhXG4gICAgY29uc29sZS53YXJuKFwiTm8gQUktZW5oYW5jZWQgYXJ0aWNsZXMgaW4gZGF0YWJhc2UsIHVzaW5nIG1vY2sgZGF0YVwiKVxuICAgIGNvbnN0IGZpbHRlcmVkTW9ja0FydGljbGVzID0gbW9ja0FpQXJ0aWNsZXMuZmlsdGVyKGFydGljbGUgPT4gXG4gICAgICBhcnRpY2xlLmxhbmd1YWdlID09PSBsYW5ndWFnZVxuICAgIClcbiAgICBcbiAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIGFydGljbGVzOiBmaWx0ZXJlZE1vY2tBcnRpY2xlcy5zbGljZSgwLCBsaW1pdCksXG4gICAgICBuZXh0UGFnZTogbnVsbCxcbiAgICAgIHVzaW5nTW9ja0RhdGE6IHRydWUsXG4gICAgICBkZWJ1ZzogXCJObyBBSS1lbmhhbmNlZCBhcnRpY2xlcyBmb3VuZCBpbiBkYXRhYmFzZVwiLFxuICAgIH0pXG4gICAgXG4gICAgcmV0dXJuIGFkZENhY2hlSGVhZGVycyhyZXNwb25zZSwgZmlsdGVyZWRNb2NrQXJ0aWNsZXMuc2xpY2UoMCwgbGltaXQpKVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIEFJLWVuaGFuY2VkIGFydGljbGVzOlwiLCBlcnJvcilcblxuICAgIC8vIFJldHVybiBtb2NrIGRhdGEgYXMgZmFsbGJhY2tcbiAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSByZXF1ZXN0Lm5leHRVcmwuc2VhcmNoUGFyYW1zXG4gICAgY29uc3QgcGFnZSA9IE51bWJlci5wYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KFwicGFnZVwiKSB8fCBcIjBcIilcbiAgICBjb25zdCBsYW5ndWFnZSA9IHNlYXJjaFBhcmFtcy5nZXQoXCJsYW5ndWFnZVwiKSB8fCBcImVuXCJcbiAgICBjb25zdCBsaW1pdCA9IDEwXG4gICAgXG4gICAgY29uc3QgZmlsdGVyZWRNb2NrQXJ0aWNsZXMgPSBtb2NrQWlBcnRpY2xlcy5maWx0ZXIoYXJ0aWNsZSA9PiBcbiAgICAgIGFydGljbGUubGFuZ3VhZ2UgPT09IGxhbmd1YWdlXG4gICAgKVxuICAgIFxuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBwYWdlICogbGltaXRcbiAgICBjb25zdCBlbmRJbmRleCA9IHN0YXJ0SW5kZXggKyBsaW1pdFxuICAgIGNvbnN0IHBhZ2luYXRlZEFydGljbGVzID0gZmlsdGVyZWRNb2NrQXJ0aWNsZXMuc2xpY2Uoc3RhcnRJbmRleCwgZW5kSW5kZXgpXG5cbiAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIGFydGljbGVzOiBwYWdpbmF0ZWRBcnRpY2xlcyxcbiAgICAgIG5leHRQYWdlOiBlbmRJbmRleCA8IGZpbHRlcmVkTW9ja0FydGljbGVzLmxlbmd0aCA/IHBhZ2UgKyAxIDogbnVsbCxcbiAgICAgIHVzaW5nTW9ja0RhdGE6IHRydWUsXG4gICAgICBlcnJvcjogXCJEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCwgdXNpbmcgbW9jayBkYXRhXCIsXG4gICAgICBkZWJ1ZzogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3JcIixcbiAgICB9KVxuICAgIFxuICAgIHJldHVybiBhZGRDYWNoZUhlYWRlcnMocmVzcG9uc2UsIHBhZ2luYXRlZEFydGljbGVzKVxuICB9XG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNoZWNrRGF0YWJhc2VTZXR1cCIsInN1cGFiYXNlIiwiZHluYW1pYyIsImFkZENhY2hlSGVhZGVycyIsInJlc3BvbnNlIiwiYXJ0aWNsZXMiLCJsYXRlc3RBcnRpY2xlVGltZSIsImxlbmd0aCIsIk1hdGgiLCJtYXgiLCJtYXAiLCJhIiwiRGF0ZSIsInB1Ymxpc2hlZEF0IiwiY3JlYXRlZF9hdCIsImdldFRpbWUiLCJub3ciLCJsYXN0TW9kaWZpZWQiLCJ0b1VUQ1N0cmluZyIsImV0YWciLCJoZWFkZXJzIiwic2V0IiwibW9ja0FpQXJ0aWNsZXMiLCJpZCIsInRpdGxlIiwic3VtbWFyeSIsImNvbnRlbnQiLCJ1cmwiLCJzb3VyY2UiLCJpbWFnZVVybCIsImNhdGVnb3J5IiwicmVhZFRpbWUiLCJpc0FpRW5oYW5jZWQiLCJsYW5ndWFnZSIsImVuaGFuY2VtZW50TWV0YWRhdGEiLCJzZWFyY2hRdWVyaWVzIiwic291cmNlcyIsImRvbWFpbiIsInNuaXBwZXQiLCJhY2Nlc3NlZEF0IiwicmVsYXRlZFRvcGljcyIsImVuaGFuY2VkQXQiLCJHRVQiLCJyZXF1ZXN0Iiwic2VhcmNoUGFyYW1zIiwibmV4dFVybCIsInBhZ2UiLCJOdW1iZXIiLCJwYXJzZUludCIsImdldCIsImxpbWl0IiwiY29uc29sZSIsImxvZyIsImlzRGF0YWJhc2VSZWFkeSIsIndhcm4iLCJmaWx0ZXJlZE1vY2tBcnRpY2xlcyIsImZpbHRlciIsImFydGljbGUiLCJzdGFydEluZGV4IiwiZW5kSW5kZXgiLCJwYWdpbmF0ZWRBcnRpY2xlcyIsInNsaWNlIiwianNvbiIsIm5leHRQYWdlIiwidXNpbmdNb2NrRGF0YSIsImRlYnVnIiwicXVlcnkiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpcyIsIm9yZGVyIiwiYXNjZW5kaW5nIiwibm90Iiwib3IiLCJkYXRhIiwiZXJyb3IiLCJyYW5nZSIsInRyYW5zZm9ybWVkQXJ0aWNsZXMiLCJhaV9zdW1tYXJ5IiwicHVibGlzaGVkX2F0IiwiaW1hZ2VfdXJsIiwiY2VpbCIsImlzX2FpX2VuaGFuY2VkIiwiZW5oYW5jZW1lbnRfbWV0YWRhdGEiLCJvcmlnaW5hbEFydGljbGVJZCIsIm9yaWdpbmFsX2FydGljbGVfaWQiLCJxdWVyeUVycm9yIiwiRXJyb3IiLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/topics/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase.ts":
/*!*************************!*\
  !*** ./lib/supabase.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkDatabaseSetup: () => (/* binding */ checkDatabaseSetup),\n/* harmony export */   checkHeadlinesTableSetup: () => (/* binding */ checkHeadlinesTableSetup),\n/* harmony export */   checkPerplexityNewsTableSetup: () => (/* binding */ checkPerplexityNewsTableSetup),\n/* harmony export */   cleanupOldHeadlines: () => (/* binding */ cleanupOldHeadlines),\n/* harmony export */   getArticleById: () => (/* binding */ getArticleById),\n/* harmony export */   getArticleStats: () => (/* binding */ getArticleStats),\n/* harmony export */   getArticles: () => (/* binding */ getArticles),\n/* harmony export */   getArticlesRegular: () => (/* binding */ getArticlesRegular),\n/* harmony export */   getBalancedArticles: () => (/* binding */ getBalancedArticles),\n/* harmony export */   getEnhancementStats: () => (/* binding */ getEnhancementStats),\n/* harmony export */   getHeadlines: () => (/* binding */ getHeadlines),\n/* harmony export */   getHeadlinesByCategory: () => (/* binding */ getHeadlinesByCategory),\n/* harmony export */   getPerplexityNews: () => (/* binding */ getPerplexityNews),\n/* harmony export */   getPerplexityNewsByCategory: () => (/* binding */ getPerplexityNewsByCategory),\n/* harmony export */   saveArticle: () => (/* binding */ saveArticle),\n/* harmony export */   saveHeadlines: () => (/* binding */ saveHeadlines),\n/* harmony export */   searchArticles: () => (/* binding */ searchArticles),\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nconst supabaseUrl = \"https://egyuetfeubznhcvmtary.supabase.co\";\n// Use service role key for server-side operations, anon key for client-side\nconst supabaseKey = process.env.SUPABASE_SERVICE_ROLE_KEY || \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVneXVldGZldWJ6bmhjdm10YXJ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEzNzUwMDUsImV4cCI6MjA2Njk1MTAwNX0.0Pp5fprFclRqGciWqI4BusTro6wgxXCFWpI6AaKH0tw\";\nif (!supabaseUrl) {\n    throw new Error(\"Missing NEXT_PUBLIC_SUPABASE_URL environment variable\");\n}\nif (!supabaseKey) {\n    throw new Error(\"Missing SUPABASE_SERVICE_ROLE_KEY or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variable\");\n}\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseKey);\nasync function saveArticle(article) {\n    try {\n        // Check if article already exists by URL\n        const { data: existing } = await supabase.from(\"articles\").select(\"id, title, created_at\").eq(\"url\", article.url).single();\n        if (existing) {\n            console.log(`⏭️  Article already exists (skipping): ${article.title}`);\n            console.log(`   📅 Originally saved: ${new Date(existing.created_at).toLocaleString()}`);\n            return {\n                ...existing,\n                skipped: true\n            };\n        }\n        // Insert new article\n        const { data, error } = await supabase.from(\"articles\").insert([\n            {\n                title: article.title,\n                content: article.content,\n                summary: article.summary,\n                ai_summary: article.ai_summary,\n                url: article.url,\n                source: article.source,\n                author: article.author,\n                image_url: article.imageUrl || article.image_url,\n                category: article.category || \"General\",\n                is_ai_enhanced: article.is_ai_enhanced || false,\n                original_article_id: article.original_article_id,\n                enhancement_metadata: article.enhancement_metadata\n            }\n        ]).select().single();\n        if (error) {\n            console.error(\"Error saving article:\", error);\n            throw error;\n        }\n        console.log(`✅ Saved new article: ${article.title}`);\n        return {\n            ...data,\n            skipped: false\n        };\n    } catch (error) {\n        console.error(\"Error in saveArticle:\", error);\n        throw error;\n    }\n}\nasync function getArticleStats() {\n    try {\n        const { data, error } = await supabase.from(\"articles\").select(\"source, created_at\").order(\"created_at\", {\n            ascending: false\n        });\n        if (error) {\n            console.error(\"Error fetching article stats:\", error);\n            return null;\n        }\n        const stats = {\n            total: data.length,\n            bySource: {},\n            latest: data[0]?.created_at,\n            oldest: data[data.length - 1]?.created_at\n        };\n        // Count by source\n        data.forEach((article)=>{\n            stats.bySource[article.source] = (stats.bySource[article.source] || 0) + 1;\n        });\n        return stats;\n    } catch (error) {\n        console.error(\"Error getting article stats:\", error);\n        return null;\n    }\n}\n// Balanced query function to ensure proportional representation from all sources\nasync function getBalancedArticles(page = 0, limit = 10, filters) {\n    try {\n        // If specific source or category filter is applied, use regular query\n        if (filters?.source || filters?.category) {\n            return getArticlesRegular(page, limit, filters);\n        }\n        // Define known sources and their desired proportions\n        const sources = [\n            \"HK01\",\n            \"on.cc\",\n            \"SingTao\",\n            \"RTHK\",\n            \"HKFP\",\n            \"ONCC\",\n            \"am730\",\n            \"scmp\",\n            \"bloomberg\"\n        ];\n        const articlesPerSource = Math.max(1, Math.floor(limit / sources.length));\n        const extraArticles = limit % sources.length;\n        const allArticles = [];\n        // Get articles from each source proportionally with proper pagination\n        for(let i = 0; i < sources.length; i++){\n            const source = sources[i];\n            const sourceLimit = articlesPerSource + (i < extraArticles ? 1 : 0);\n            let query = supabase.from(\"articles\").select(\"*\").in(\"source\", [\n                source,\n                `${source} (AI Enhanced)`\n            ]).order(\"created_at\", {\n                ascending: false\n            });\n            // Apply AI enhanced filter if specified\n            if (filters?.isAiEnhanced !== undefined) {\n                query = query.eq(\"is_ai_enhanced\", filters.isAiEnhanced);\n            }\n            // Apply language filter if specified - use only metadata (language column doesn't exist)\n            if (filters?.language) {\n                if (filters.language !== \"en\") {\n                    // For non-English languages, check metadata language\n                    query = query.eq(\"enhancement_metadata->>language\", filters.language);\n                } else {\n                    // For English, include articles where metadata shows 'en' OR metadata language is null/missing\n                    query = query.or(`enhancement_metadata->>language.eq.en,enhancement_metadata->>language.is.null`);\n                }\n            }\n            // Use proper pagination with range instead of limit + slice\n            const startIndex = sourceLimit * page;\n            const endIndex = startIndex + sourceLimit - 1;\n            const { data, error } = await query.range(startIndex, endIndex);\n            if (!error && data) {\n                allArticles.push(...data);\n            }\n        }\n        // Sort the mixed articles by creation date (newest first)\n        allArticles.sort((a, b)=>new Date(b.created_at).getTime() - new Date(a.created_at).getTime());\n        return allArticles.slice(0, limit);\n    } catch (error) {\n        console.error(\"Error fetching balanced articles:\", error);\n        // Fallback to regular query\n        return getArticlesRegular(page, limit, filters);\n    }\n}\n// Original query function (renamed for clarity)\nasync function getArticlesRegular(page = 0, limit = 10, filters) {\n    try {\n        let query = supabase.from(\"articles\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        });\n        // Apply filters if provided\n        if (filters?.source) {\n            query = query.eq(\"source\", filters.source);\n        }\n        if (filters?.category) {\n            query = query.eq(\"category\", filters.category);\n        }\n        if (filters?.isAiEnhanced !== undefined) {\n            query = query.eq(\"is_ai_enhanced\", filters.isAiEnhanced);\n        }\n        // Apply language filter if specified - use only metadata (language column doesn't exist)\n        if (filters?.language) {\n            if (filters.language !== \"en\") {\n                // For non-English languages, check metadata language\n                query = query.eq(\"enhancement_metadata->>language\", filters.language);\n            } else {\n                // For English, include articles where metadata shows 'en' OR metadata language is null/missing\n                query = query.or(`enhancement_metadata->>language.eq.en,enhancement_metadata->>language.is.null`);\n            }\n        }\n        if (filters?.hasEnrichment !== undefined) {\n            if (filters.hasEnrichment) {\n                query = query.not(\"ai_summary\", \"is\", null);\n            } else {\n                query = query.is(\"ai_summary\", null);\n            }\n        }\n        const { data, error } = await query.range(page * limit, (page + 1) * limit - 1);\n        if (error) {\n            // If table doesn't exist, return empty array instead of throwing\n            if (error.code === \"42P01\" || error.message.includes(\"does not exist\")) {\n                console.warn(\"Articles table does not exist. Please run the database setup.\");\n                return [];\n            }\n            throw error;\n        }\n        return data || [];\n    } catch (error) {\n        console.error(\"Error fetching articles:\", error);\n        return [];\n    }\n}\n// Main export - use regular query for better pagination reliability\nasync function getArticles(page = 0, limit = 10, filters) {\n    return getArticlesRegular(page, limit, filters);\n}\nasync function searchArticles(query) {\n    try {\n        const { data, error } = await supabase.from(\"articles\").select(\"*\").or(`title.ilike.%${query}%,summary.ilike.%${query}%,ai_summary.ilike.%${query}%`).order(\"created_at\", {\n            ascending: false\n        }).limit(20);\n        if (error) {\n            // If table doesn't exist, return empty array instead of throwing\n            if (error.code === \"42P01\" || error.message.includes(\"does not exist\")) {\n                console.warn(\"Articles table does not exist. Please run the database setup.\");\n                return [];\n            }\n            throw error;\n        }\n        return data || [];\n    } catch (error) {\n        console.error(\"Error searching articles:\", error);\n        return [];\n    }\n}\nasync function getArticleById(id) {\n    try {\n        console.log(`📍 getArticleById called with ID: ${id}`);\n        const { data, error } = await supabase.from(\"articles\").select(\"*\").eq(\"id\", id).single();\n        if (error) {\n            console.error(`❌ Error fetching article ${id}:`, error);\n            // If not found, log sample IDs for debugging\n            if (error.code === \"PGRST116\") {\n                const { data: sampleArticles } = await supabase.from(\"articles\").select(\"id\").limit(5);\n                console.log(\"\\uD83D\\uDCCB Sample article IDs in database:\", sampleArticles?.map((a)=>a.id));\n            }\n            // If table doesn't exist, return null instead of throwing\n            if (error.code === \"42P01\" || error.message.includes(\"does not exist\")) {\n                console.warn(\"Articles table does not exist. Please run the database setup.\");\n                return null;\n            }\n            throw error;\n        }\n        console.log(`✅ Found article: ${data.title}`);\n        return data;\n    } catch (error) {\n        console.error(\"Error fetching article by ID:\", error);\n        return null;\n    }\n}\n// Function to get enhancement statistics\nasync function getEnhancementStats() {\n    try {\n        const { data, error } = await supabase.rpc(\"get_enhancement_stats\");\n        if (error) {\n            console.error(\"Error fetching enhancement stats:\", error);\n            return null;\n        }\n        return data?.[0] || null;\n    } catch (error) {\n        console.error(\"Error getting enhancement stats:\", error);\n        return null;\n    }\n}\n// Function to check if database is set up\nasync function checkDatabaseSetup() {\n    try {\n        console.log(\"Checking database setup...\");\n        // Add timeout to prevent hanging requests\n        const timeoutPromise = new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Database check timeout\")), 3000));\n        // Try to select from articles table with timeout\n        const dbPromise = supabase.from(\"articles\").select(\"id\").limit(1);\n        const { data, error } = await Promise.race([\n            dbPromise,\n            timeoutPromise\n        ]);\n        console.log(\"Database check result:\", {\n            data,\n            error\n        });\n        if (error) {\n            console.error(\"Database check error:\", error);\n            // Check for specific error codes that indicate table doesn't exist\n            if (error.code === \"42P01\" || error.message.includes(\"does not exist\") || error.message.includes(\"relation\") || error.message.includes(\"table\")) {\n                return false;\n            }\n            // Check for RLS/permission errors (common after enabling Realtime)\n            if (error.code === \"42501\" || error.message.includes(\"permission denied\") || error.message.includes(\"RLS\") || error.message.includes(\"policy\")) {\n                console.warn(\"Database exists but RLS policies may be blocking access\");\n                return false;\n            }\n            // For other errors, assume table exists but there might be permission issues\n            return true;\n        }\n        console.log(\"Database setup check passed\");\n        return true;\n    } catch (error) {\n        console.error(\"Database setup check failed:\", error);\n        // Handle timeout and other errors\n        if (error.message === \"Database check timeout\") {\n            console.warn(\"Database check timed out - likely RLS policy issue\");\n        }\n        return false;\n    }\n}\nasync function saveHeadlines(headlines) {\n    try {\n        const { data, error } = await supabase.from(\"headlines\").insert(headlines).select();\n        if (error) {\n            console.error(\"Error saving headlines:\", error);\n            throw error;\n        }\n        console.log(`✅ Saved ${headlines.length} headlines`);\n        return data;\n    } catch (error) {\n        console.error(\"Error in saveHeadlines:\", error);\n        throw error;\n    }\n}\nasync function getHeadlines(category) {\n    try {\n        let query = supabase.from(\"headlines\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        });\n        if (category) {\n            query = query.eq(\"category\", category);\n        }\n        const { data, error } = await query;\n        if (error) {\n            if (error.code === \"42P01\" || error.message.includes(\"does not exist\")) {\n                console.warn(\"Headlines table does not exist. Please run the database setup.\");\n                return [];\n            }\n            throw error;\n        }\n        return data || [];\n    } catch (error) {\n        console.error(\"Error fetching headlines:\", error);\n        return [];\n    }\n}\nasync function getHeadlinesByCategory() {\n    try {\n        const { data, error } = await supabase.from(\"headlines\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        });\n        if (error) {\n            if (error.code === \"42P01\" || error.message.includes(\"does not exist\")) {\n                console.warn(\"Headlines table does not exist. Please run the database setup.\");\n                return {};\n            }\n            throw error;\n        }\n        // Group headlines by category (max 10 per category)\n        const groupedHeadlines = (data || []).reduce((acc, headline)=>{\n            if (!acc[headline.category]) {\n                acc[headline.category] = [];\n            }\n            if (acc[headline.category].length < 10) {\n                acc[headline.category].push(headline);\n            }\n            return acc;\n        }, {});\n        return groupedHeadlines;\n    } catch (error) {\n        console.error(\"Error fetching headlines by category:\", error);\n        return {};\n    }\n}\nasync function cleanupOldHeadlines() {\n    try {\n        const { error } = await supabase.from(\"headlines\").delete().lt(\"created_at\", new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString());\n        if (error) {\n            console.error(\"Error cleaning up old headlines:\", error);\n            throw error;\n        }\n        console.log(\"✅ Cleaned up old headlines\");\n    } catch (error) {\n        console.error(\"Error in cleanupOldHeadlines:\", error);\n        throw error;\n    }\n}\nasync function checkHeadlinesTableSetup() {\n    try {\n        const { data, error } = await supabase.from(\"headlines\").select(\"id\").limit(1);\n        if (error) {\n            if (error.code === \"42P01\" || error.message.includes(\"does not exist\")) {\n                return false;\n            }\n            throw error;\n        }\n        return true;\n    } catch (error) {\n        console.error(\"Headlines table setup check failed:\", error);\n        return false;\n    }\n}\nasync function getPerplexityNews(category, limit = 20) {\n    try {\n        let query = supabase.from(\"perplexity_news\").select(\"*\").eq(\"article_status\", \"ready\").order(\"updated_at\", {\n            ascending: false\n        });\n        if (category) {\n            query = query.eq(\"category\", category);\n        }\n        const { data, error } = await query.limit(limit);\n        if (error) {\n            if (error.code === \"42P01\" || error.message.includes(\"does not exist\")) {\n                console.warn(\"Perplexity news table does not exist. Please run the database setup.\");\n                return [];\n            }\n            throw error;\n        }\n        return data || [];\n    } catch (error) {\n        console.error(\"Error fetching Perplexity news:\", error);\n        return [];\n    }\n}\nasync function getPerplexityNewsByCategory() {\n    try {\n        const { data, error } = await supabase.from(\"perplexity_news\").select(\"*\").eq(\"article_status\", \"ready\").order(\"updated_at\", {\n            ascending: false\n        });\n        if (error) {\n            if (error.code === \"42P01\" || error.message.includes(\"does not exist\")) {\n                console.warn(\"Perplexity news table does not exist. Please run the database setup.\");\n                return {};\n            }\n            throw error;\n        }\n        // Group by category (max 10 per category)\n        const groupedNews = (data || []).reduce((acc, article)=>{\n            if (!acc[article.category]) {\n                acc[article.category] = [];\n            }\n            if (acc[article.category].length < 10) {\n                acc[article.category].push(article);\n            }\n            return acc;\n        }, {});\n        return groupedNews;\n    } catch (error) {\n        console.error(\"Error fetching Perplexity news by category:\", error);\n        return {};\n    }\n}\nasync function checkPerplexityNewsTableSetup() {\n    try {\n        const { data, error } = await supabase.from(\"perplexity_news\").select(\"id\").limit(1);\n        if (error) {\n            if (error.code === \"42P01\" || error.message.includes(\"does not exist\")) {\n                return false;\n            }\n            throw error;\n        }\n        return true;\n    } catch (error) {\n        console.error(\"Perplexity news table setup check failed:\", error);\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUVKLE9BQU9VO0lBQ1QsRUFBRSxPQUFPM0YsT0FBTztRQUNkUCxRQUFRTyxLQUFLLENBQUMsK0NBQStDQTtRQUM3RCxPQUFPLENBQUM7SUFDVjtBQUNGO0FBRU8sZUFBZTRGO0lBQ3BCLElBQUk7UUFDRixNQUFNLEVBQUUxRyxJQUFJLEVBQUVjLEtBQUssRUFBRSxHQUFHLE1BQU1qQixTQUMzQkssSUFBSSxDQUFDLG1CQUNMQyxNQUFNLENBQUMsTUFDUG9DLEtBQUssQ0FBQztRQUVULElBQUl6QixPQUFPO1lBQ1QsSUFBSUEsTUFBTXVELElBQUksS0FBSyxXQUFXdkQsTUFBTXdELE9BQU8sQ0FBQ0MsUUFBUSxDQUFDLG1CQUFtQjtnQkFDdEUsT0FBTztZQUNUO1lBQ0EsTUFBTXpEO1FBQ1I7UUFFQSxPQUFPO0lBQ1QsRUFBRSxPQUFPQSxPQUFPO1FBQ2RQLFFBQVFPLEtBQUssQ0FBQyw2Q0FBNkNBO1FBQzNELE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaGtpLXpvbmUvLi9saWIvc3VwYWJhc2UudHM/Yzk5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCJcblxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhXG4vLyBVc2Ugc2VydmljZSByb2xlIGtleSBmb3Igc2VydmVyLXNpZGUgb3BlcmF0aW9ucywgYW5vbiBrZXkgZm9yIGNsaWVudC1zaWRlXG5jb25zdCBzdXBhYmFzZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgfHwgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhXG5cbmlmICghc3VwYWJhc2VVcmwpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIE5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCBlbnZpcm9ubWVudCB2YXJpYWJsZScpXG59XG5cbmlmICghc3VwYWJhc2VLZXkpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIFNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgb3IgTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGUnKVxufVxuXG5leHBvcnQgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlS2V5KVxuXG5leHBvcnQgaW50ZXJmYWNlIEFydGljbGUge1xuICBpZD86IHN0cmluZ1xuICB0aXRsZTogc3RyaW5nXG4gIGNvbnRlbnQ6IHN0cmluZ1xuICBzdW1tYXJ5OiBzdHJpbmdcbiAgYWlfc3VtbWFyeT86IHN0cmluZ1xuICB1cmw6IHN0cmluZ1xuICBzb3VyY2U6IHN0cmluZ1xuICBhdXRob3I/OiBzdHJpbmdcbiAgcHVibGlzaGVkX2F0Pzogc3RyaW5nXG4gIGltYWdlX3VybD86IHN0cmluZ1xuICBpbWFnZV9tZXRhZGF0YT86IHtcbiAgICBvcmlnaW5hbD86IHN0cmluZ1xuICAgIG9wdGltaXplZD86IHN0cmluZ1xuICAgIHdoYXRzYXBwPzogc3RyaW5nXG4gIH1cbiAgY2F0ZWdvcnk/OiBzdHJpbmdcbiAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICB1cGRhdGVkX2F0Pzogc3RyaW5nXG4gIGlzX2FpX2VuaGFuY2VkPzogYm9vbGVhblxuICBvcmlnaW5hbF9hcnRpY2xlX2lkPzogc3RyaW5nXG4gIGVuaGFuY2VtZW50X21ldGFkYXRhPzoge1xuICAgIHNlYXJjaFF1ZXJpZXM6IHN0cmluZ1tdXG4gICAgc291cmNlczogc3RyaW5nW11cbiAgICByZWxhdGVkVG9waWNzOiBzdHJpbmdbXVxuICAgIGVuaGFuY2VkQXQ6IHN0cmluZ1xuICAgIGVuaGFuY2VtZW50Q29zdD86IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlQXJ0aWNsZShhcnRpY2xlOiBBcnRpY2xlKSB7XG4gIHRyeSB7XG4gICAgLy8gQ2hlY2sgaWYgYXJ0aWNsZSBhbHJlYWR5IGV4aXN0cyBieSBVUkxcbiAgICBjb25zdCB7IGRhdGE6IGV4aXN0aW5nIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oXCJhcnRpY2xlc1wiKVxuICAgICAgLnNlbGVjdChcImlkLCB0aXRsZSwgY3JlYXRlZF9hdFwiKVxuICAgICAgLmVxKFwidXJsXCIsIGFydGljbGUudXJsKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgIGNvbnNvbGUubG9nKGDij63vuI8gIEFydGljbGUgYWxyZWFkeSBleGlzdHMgKHNraXBwaW5nKTogJHthcnRpY2xlLnRpdGxlfWApXG4gICAgICBjb25zb2xlLmxvZyhgICAg8J+ThSBPcmlnaW5hbGx5IHNhdmVkOiAke25ldyBEYXRlKGV4aXN0aW5nLmNyZWF0ZWRfYXQpLnRvTG9jYWxlU3RyaW5nKCl9YClcbiAgICAgIHJldHVybiB7IC4uLmV4aXN0aW5nLCBza2lwcGVkOiB0cnVlIH1cbiAgICB9XG5cbiAgICAvLyBJbnNlcnQgbmV3IGFydGljbGVcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oXCJhcnRpY2xlc1wiKVxuICAgICAgLmluc2VydChbXG4gICAgICAgIHtcbiAgICAgICAgICB0aXRsZTogYXJ0aWNsZS50aXRsZSxcbiAgICAgICAgICBjb250ZW50OiBhcnRpY2xlLmNvbnRlbnQsXG4gICAgICAgICAgc3VtbWFyeTogYXJ0aWNsZS5zdW1tYXJ5LFxuICAgICAgICAgIGFpX3N1bW1hcnk6IGFydGljbGUuYWlfc3VtbWFyeSxcbiAgICAgICAgICB1cmw6IGFydGljbGUudXJsLFxuICAgICAgICAgIHNvdXJjZTogYXJ0aWNsZS5zb3VyY2UsXG4gICAgICAgICAgYXV0aG9yOiBhcnRpY2xlLmF1dGhvcixcbiAgICAgICAgICBpbWFnZV91cmw6IChhcnRpY2xlIGFzIGFueSkuaW1hZ2VVcmwgfHwgYXJ0aWNsZS5pbWFnZV91cmwsXG4gICAgICAgICAgY2F0ZWdvcnk6IGFydGljbGUuY2F0ZWdvcnkgfHwgXCJHZW5lcmFsXCIsXG4gICAgICAgICAgaXNfYWlfZW5oYW5jZWQ6IGFydGljbGUuaXNfYWlfZW5oYW5jZWQgfHwgZmFsc2UsXG4gICAgICAgICAgb3JpZ2luYWxfYXJ0aWNsZV9pZDogYXJ0aWNsZS5vcmlnaW5hbF9hcnRpY2xlX2lkLFxuICAgICAgICAgIGVuaGFuY2VtZW50X21ldGFkYXRhOiBhcnRpY2xlLmVuaGFuY2VtZW50X21ldGFkYXRhLFxuICAgICAgICB9LFxuICAgICAgXSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzYXZpbmcgYXJ0aWNsZTpcIiwgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGDinIUgU2F2ZWQgbmV3IGFydGljbGU6ICR7YXJ0aWNsZS50aXRsZX1gKVxuICAgIHJldHVybiB7IC4uLmRhdGEsIHNraXBwZWQ6IGZhbHNlIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW4gc2F2ZUFydGljbGU6XCIsIGVycm9yKVxuICAgIHRocm93IGVycm9yXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFydGljbGVTdGF0cygpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oXCJhcnRpY2xlc1wiKVxuICAgICAgLnNlbGVjdChcInNvdXJjZSwgY3JlYXRlZF9hdFwiKVxuICAgICAgLm9yZGVyKFwiY3JlYXRlZF9hdFwiLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGFydGljbGUgc3RhdHM6XCIsIGVycm9yKVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICBjb25zdCBzdGF0cyA9IHtcbiAgICAgIHRvdGFsOiBkYXRhLmxlbmd0aCxcbiAgICAgIGJ5U291cmNlOiB7fSxcbiAgICAgIGxhdGVzdDogZGF0YVswXT8uY3JlYXRlZF9hdCxcbiAgICAgIG9sZGVzdDogZGF0YVtkYXRhLmxlbmd0aCAtIDFdPy5jcmVhdGVkX2F0LFxuICAgIH1cblxuICAgIC8vIENvdW50IGJ5IHNvdXJjZVxuICAgIGRhdGEuZm9yRWFjaCgoYXJ0aWNsZSkgPT4ge1xuICAgICAgc3RhdHMuYnlTb3VyY2VbYXJ0aWNsZS5zb3VyY2VdID0gKHN0YXRzLmJ5U291cmNlW2FydGljbGUuc291cmNlXSB8fCAwKSArIDFcbiAgICB9KVxuXG4gICAgcmV0dXJuIHN0YXRzXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGdldHRpbmcgYXJ0aWNsZSBzdGF0czpcIiwgZXJyb3IpXG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuXG4vLyBCYWxhbmNlZCBxdWVyeSBmdW5jdGlvbiB0byBlbnN1cmUgcHJvcG9ydGlvbmFsIHJlcHJlc2VudGF0aW9uIGZyb20gYWxsIHNvdXJjZXNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRCYWxhbmNlZEFydGljbGVzKHBhZ2UgPSAwLCBsaW1pdCA9IDEwLCBmaWx0ZXJzPzogeyBzb3VyY2U/OiBzdHJpbmcsIGlzQWlFbmhhbmNlZD86IGJvb2xlYW4sIGxhbmd1YWdlPzogc3RyaW5nLCBjYXRlZ29yeT86IHN0cmluZywgaGFzRW5yaWNobWVudD86IGJvb2xlYW4gfSkge1xuICB0cnkge1xuICAgIC8vIElmIHNwZWNpZmljIHNvdXJjZSBvciBjYXRlZ29yeSBmaWx0ZXIgaXMgYXBwbGllZCwgdXNlIHJlZ3VsYXIgcXVlcnlcbiAgICBpZiAoZmlsdGVycz8uc291cmNlIHx8IGZpbHRlcnM/LmNhdGVnb3J5KSB7XG4gICAgICByZXR1cm4gZ2V0QXJ0aWNsZXNSZWd1bGFyKHBhZ2UsIGxpbWl0LCBmaWx0ZXJzKVxuICAgIH1cblxuICAgIC8vIERlZmluZSBrbm93biBzb3VyY2VzIGFuZCB0aGVpciBkZXNpcmVkIHByb3BvcnRpb25zXG4gICAgY29uc3Qgc291cmNlcyA9IFsnSEswMScsICdvbi5jYycsICdTaW5nVGFvJywgJ1JUSEsnLCAnSEtGUCcsICdPTkNDJywgJ2FtNzMwJywgJ3NjbXAnLCAnYmxvb21iZXJnJ11cbiAgICBjb25zdCBhcnRpY2xlc1BlclNvdXJjZSA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IobGltaXQgLyBzb3VyY2VzLmxlbmd0aCkpXG4gICAgY29uc3QgZXh0cmFBcnRpY2xlcyA9IGxpbWl0ICUgc291cmNlcy5sZW5ndGhcbiAgICBcbiAgICBjb25zdCBhbGxBcnRpY2xlcyA9IFtdXG4gICAgXG4gICAgLy8gR2V0IGFydGljbGVzIGZyb20gZWFjaCBzb3VyY2UgcHJvcG9ydGlvbmFsbHkgd2l0aCBwcm9wZXIgcGFnaW5hdGlvblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc291cmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qgc291cmNlID0gc291cmNlc1tpXVxuICAgICAgY29uc3Qgc291cmNlTGltaXQgPSBhcnRpY2xlc1BlclNvdXJjZSArIChpIDwgZXh0cmFBcnRpY2xlcyA/IDEgOiAwKVxuICAgICAgXG4gICAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZVxuICAgICAgICAuZnJvbShcImFydGljbGVzXCIpXG4gICAgICAgIC5zZWxlY3QoXCIqXCIpXG4gICAgICAgIC5pbignc291cmNlJywgW3NvdXJjZSwgYCR7c291cmNlfSAoQUkgRW5oYW5jZWQpYF0pXG4gICAgICAgIC5vcmRlcihcImNyZWF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICBcbiAgICAgIC8vIEFwcGx5IEFJIGVuaGFuY2VkIGZpbHRlciBpZiBzcGVjaWZpZWRcbiAgICAgIGlmIChmaWx0ZXJzPy5pc0FpRW5oYW5jZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdpc19haV9lbmhhbmNlZCcsIGZpbHRlcnMuaXNBaUVuaGFuY2VkKVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBBcHBseSBsYW5ndWFnZSBmaWx0ZXIgaWYgc3BlY2lmaWVkIC0gdXNlIG9ubHkgbWV0YWRhdGEgKGxhbmd1YWdlIGNvbHVtbiBkb2Vzbid0IGV4aXN0KVxuICAgICAgaWYgKGZpbHRlcnM/Lmxhbmd1YWdlKSB7XG4gICAgICAgIGlmIChmaWx0ZXJzLmxhbmd1YWdlICE9PSBcImVuXCIpIHtcbiAgICAgICAgICAvLyBGb3Igbm9uLUVuZ2xpc2ggbGFuZ3VhZ2VzLCBjaGVjayBtZXRhZGF0YSBsYW5ndWFnZVxuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2VuaGFuY2VtZW50X21ldGFkYXRhLT4+bGFuZ3VhZ2UnLCBmaWx0ZXJzLmxhbmd1YWdlKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEZvciBFbmdsaXNoLCBpbmNsdWRlIGFydGljbGVzIHdoZXJlIG1ldGFkYXRhIHNob3dzICdlbicgT1IgbWV0YWRhdGEgbGFuZ3VhZ2UgaXMgbnVsbC9taXNzaW5nXG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5vcihgZW5oYW5jZW1lbnRfbWV0YWRhdGEtPj5sYW5ndWFnZS5lcS5lbixlbmhhbmNlbWVudF9tZXRhZGF0YS0+Pmxhbmd1YWdlLmlzLm51bGxgKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFVzZSBwcm9wZXIgcGFnaW5hdGlvbiB3aXRoIHJhbmdlIGluc3RlYWQgb2YgbGltaXQgKyBzbGljZVxuICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IHNvdXJjZUxpbWl0ICogcGFnZVxuICAgICAgY29uc3QgZW5kSW5kZXggPSBzdGFydEluZGV4ICsgc291cmNlTGltaXQgLSAxXG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5LnJhbmdlKHN0YXJ0SW5kZXgsIGVuZEluZGV4KVxuICAgICAgXG4gICAgICBpZiAoIWVycm9yICYmIGRhdGEpIHtcbiAgICAgICAgYWxsQXJ0aWNsZXMucHVzaCguLi5kYXRhKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBTb3J0IHRoZSBtaXhlZCBhcnRpY2xlcyBieSBjcmVhdGlvbiBkYXRlIChuZXdlc3QgZmlyc3QpXG4gICAgYWxsQXJ0aWNsZXMuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi5jcmVhdGVkX2F0KS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhLmNyZWF0ZWRfYXQpLmdldFRpbWUoKSlcbiAgICBcbiAgICByZXR1cm4gYWxsQXJ0aWNsZXMuc2xpY2UoMCwgbGltaXQpXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGJhbGFuY2VkIGFydGljbGVzOlwiLCBlcnJvcilcbiAgICAvLyBGYWxsYmFjayB0byByZWd1bGFyIHF1ZXJ5XG4gICAgcmV0dXJuIGdldEFydGljbGVzUmVndWxhcihwYWdlLCBsaW1pdCwgZmlsdGVycylcbiAgfVxufVxuXG4vLyBPcmlnaW5hbCBxdWVyeSBmdW5jdGlvbiAocmVuYW1lZCBmb3IgY2xhcml0eSlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBcnRpY2xlc1JlZ3VsYXIocGFnZSA9IDAsIGxpbWl0ID0gMTAsIGZpbHRlcnM/OiB7IHNvdXJjZT86IHN0cmluZywgaXNBaUVuaGFuY2VkPzogYm9vbGVhbiwgbGFuZ3VhZ2U/OiBzdHJpbmcsIGNhdGVnb3J5Pzogc3RyaW5nLCBoYXNFbnJpY2htZW50PzogYm9vbGVhbiB9KSB7XG4gIHRyeSB7XG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcbiAgICAgIC5mcm9tKFwiYXJ0aWNsZXNcIilcbiAgICAgIC5zZWxlY3QoXCIqXCIpXG4gICAgICAub3JkZXIoXCJjcmVhdGVkX2F0XCIsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgIFxuICAgIC8vIEFwcGx5IGZpbHRlcnMgaWYgcHJvdmlkZWRcbiAgICBpZiAoZmlsdGVycz8uc291cmNlKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdzb3VyY2UnLCBmaWx0ZXJzLnNvdXJjZSlcbiAgICB9XG4gICAgXG4gICAgaWYgKGZpbHRlcnM/LmNhdGVnb3J5KSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdjYXRlZ29yeScsIGZpbHRlcnMuY2F0ZWdvcnkpXG4gICAgfVxuICAgIFxuICAgIGlmIChmaWx0ZXJzPy5pc0FpRW5oYW5jZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnaXNfYWlfZW5oYW5jZWQnLCBmaWx0ZXJzLmlzQWlFbmhhbmNlZClcbiAgICB9XG4gICAgXG4gICAgLy8gQXBwbHkgbGFuZ3VhZ2UgZmlsdGVyIGlmIHNwZWNpZmllZCAtIHVzZSBvbmx5IG1ldGFkYXRhIChsYW5ndWFnZSBjb2x1bW4gZG9lc24ndCBleGlzdClcbiAgICBpZiAoZmlsdGVycz8ubGFuZ3VhZ2UpIHtcbiAgICAgIGlmIChmaWx0ZXJzLmxhbmd1YWdlICE9PSBcImVuXCIpIHtcbiAgICAgICAgLy8gRm9yIG5vbi1FbmdsaXNoIGxhbmd1YWdlcywgY2hlY2sgbWV0YWRhdGEgbGFuZ3VhZ2VcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnZW5oYW5jZW1lbnRfbWV0YWRhdGEtPj5sYW5ndWFnZScsIGZpbHRlcnMubGFuZ3VhZ2UpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGb3IgRW5nbGlzaCwgaW5jbHVkZSBhcnRpY2xlcyB3aGVyZSBtZXRhZGF0YSBzaG93cyAnZW4nIE9SIG1ldGFkYXRhIGxhbmd1YWdlIGlzIG51bGwvbWlzc2luZ1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5Lm9yKGBlbmhhbmNlbWVudF9tZXRhZGF0YS0+Pmxhbmd1YWdlLmVxLmVuLGVuaGFuY2VtZW50X21ldGFkYXRhLT4+bGFuZ3VhZ2UuaXMubnVsbGApXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGlmIChmaWx0ZXJzPy5oYXNFbnJpY2htZW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmIChmaWx0ZXJzLmhhc0VucmljaG1lbnQpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5ub3QoJ2FpX3N1bW1hcnknLCAnaXMnLCBudWxsKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5pcygnYWlfc3VtbWFyeScsIG51bGwpXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5LnJhbmdlKHBhZ2UgKiBsaW1pdCwgKHBhZ2UgKyAxKSAqIGxpbWl0IC0gMSlcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgLy8gSWYgdGFibGUgZG9lc24ndCBleGlzdCwgcmV0dXJuIGVtcHR5IGFycmF5IGluc3RlYWQgb2YgdGhyb3dpbmdcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSBcIjQyUDAxXCIgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcImRvZXMgbm90IGV4aXN0XCIpKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIkFydGljbGVzIHRhYmxlIGRvZXMgbm90IGV4aXN0LiBQbGVhc2UgcnVuIHRoZSBkYXRhYmFzZSBzZXR1cC5cIilcbiAgICAgICAgcmV0dXJuIFtdXG4gICAgICB9XG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgICByZXR1cm4gZGF0YSB8fCBbXVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBhcnRpY2xlczpcIiwgZXJyb3IpXG4gICAgcmV0dXJuIFtdXG4gIH1cbn1cblxuLy8gTWFpbiBleHBvcnQgLSB1c2UgcmVndWxhciBxdWVyeSBmb3IgYmV0dGVyIHBhZ2luYXRpb24gcmVsaWFiaWxpdHlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBcnRpY2xlcyhwYWdlID0gMCwgbGltaXQgPSAxMCwgZmlsdGVycz86IHsgc291cmNlPzogc3RyaW5nLCBpc0FpRW5oYW5jZWQ/OiBib29sZWFuLCBsYW5ndWFnZT86IHN0cmluZywgY2F0ZWdvcnk/OiBzdHJpbmcsIGhhc0VucmljaG1lbnQ/OiBib29sZWFuIH0pIHtcbiAgcmV0dXJuIGdldEFydGljbGVzUmVndWxhcihwYWdlLCBsaW1pdCwgZmlsdGVycylcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaEFydGljbGVzKHF1ZXJ5OiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oXCJhcnRpY2xlc1wiKVxuICAgICAgLnNlbGVjdChcIipcIilcbiAgICAgIC5vcihgdGl0bGUuaWxpa2UuJSR7cXVlcnl9JSxzdW1tYXJ5LmlsaWtlLiUke3F1ZXJ5fSUsYWlfc3VtbWFyeS5pbGlrZS4lJHtxdWVyeX0lYClcbiAgICAgIC5vcmRlcihcImNyZWF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAubGltaXQoMjApXG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIC8vIElmIHRhYmxlIGRvZXNuJ3QgZXhpc3QsIHJldHVybiBlbXB0eSBhcnJheSBpbnN0ZWFkIG9mIHRocm93aW5nXG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gXCI0MlAwMVwiIHx8IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJkb2VzIG5vdCBleGlzdFwiKSkge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJBcnRpY2xlcyB0YWJsZSBkb2VzIG5vdCBleGlzdC4gUGxlYXNlIHJ1biB0aGUgZGF0YWJhc2Ugc2V0dXAuXCIpXG4gICAgICAgIHJldHVybiBbXVxuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gICAgcmV0dXJuIGRhdGEgfHwgW11cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2VhcmNoaW5nIGFydGljbGVzOlwiLCBlcnJvcilcbiAgICByZXR1cm4gW11cbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QXJ0aWNsZUJ5SWQoaWQ6IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKGDwn5ONIGdldEFydGljbGVCeUlkIGNhbGxlZCB3aXRoIElEOiAke2lkfWApXG4gICAgXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbShcImFydGljbGVzXCIpLnNlbGVjdChcIipcIikuZXEoXCJpZFwiLCBpZCkuc2luZ2xlKClcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihg4p2MIEVycm9yIGZldGNoaW5nIGFydGljbGUgJHtpZH06YCwgZXJyb3IpXG4gICAgICBcbiAgICAgIC8vIElmIG5vdCBmb3VuZCwgbG9nIHNhbXBsZSBJRHMgZm9yIGRlYnVnZ2luZ1xuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQR1JTVDExNicpIHtcbiAgICAgICAgY29uc3QgeyBkYXRhOiBzYW1wbGVBcnRpY2xlcyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAuZnJvbShcImFydGljbGVzXCIpXG4gICAgICAgICAgLnNlbGVjdChcImlkXCIpXG4gICAgICAgICAgLmxpbWl0KDUpXG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+TiyBTYW1wbGUgYXJ0aWNsZSBJRHMgaW4gZGF0YWJhc2U6XCIsIHNhbXBsZUFydGljbGVzPy5tYXAoYSA9PiBhLmlkKSlcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSWYgdGFibGUgZG9lc24ndCBleGlzdCwgcmV0dXJuIG51bGwgaW5zdGVhZCBvZiB0aHJvd2luZ1xuICAgICAgaWYgKGVycm9yLmNvZGUgPT09IFwiNDJQMDFcIiB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwiZG9lcyBub3QgZXhpc3RcIikpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiQXJ0aWNsZXMgdGFibGUgZG9lcyBub3QgZXhpc3QuIFBsZWFzZSBydW4gdGhlIGRhdGFiYXNlIHNldHVwLlwiKVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coYOKchSBGb3VuZCBhcnRpY2xlOiAke2RhdGEudGl0bGV9YClcbiAgICByZXR1cm4gZGF0YVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBhcnRpY2xlIGJ5IElEOlwiLCBlcnJvcilcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG5cbi8vIEZ1bmN0aW9uIHRvIGdldCBlbmhhbmNlbWVudCBzdGF0aXN0aWNzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RW5oYW5jZW1lbnRTdGF0cygpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5ycGMoJ2dldF9lbmhhbmNlbWVudF9zdGF0cycpXG4gICAgXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBlbmhhbmNlbWVudCBzdGF0czonLCBlcnJvcilcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBkYXRhPy5bMF0gfHwgbnVsbFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgZW5oYW5jZW1lbnQgc3RhdHM6JywgZXJyb3IpXG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuXG4vLyBGdW5jdGlvbiB0byBjaGVjayBpZiBkYXRhYmFzZSBpcyBzZXQgdXBcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja0RhdGFiYXNlU2V0dXAoKSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coXCJDaGVja2luZyBkYXRhYmFzZSBzZXR1cC4uLlwiKVxuXG4gICAgLy8gQWRkIHRpbWVvdXQgdG8gcHJldmVudCBoYW5naW5nIHJlcXVlc3RzXG4gICAgY29uc3QgdGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZTxuZXZlcj4oKF8sIHJlamVjdCkgPT4gXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgRXJyb3IoJ0RhdGFiYXNlIGNoZWNrIHRpbWVvdXQnKSksIDMwMDApXG4gICAgKVxuXG4gICAgLy8gVHJ5IHRvIHNlbGVjdCBmcm9tIGFydGljbGVzIHRhYmxlIHdpdGggdGltZW91dFxuICAgIGNvbnN0IGRiUHJvbWlzZSA9IHN1cGFiYXNlLmZyb20oXCJhcnRpY2xlc1wiKS5zZWxlY3QoXCJpZFwiKS5saW1pdCgxKVxuICAgIFxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IFByb21pc2UucmFjZShbZGJQcm9taXNlLCB0aW1lb3V0UHJvbWlzZV0pXG5cbiAgICBjb25zb2xlLmxvZyhcIkRhdGFiYXNlIGNoZWNrIHJlc3VsdDpcIiwgeyBkYXRhLCBlcnJvciB9KVxuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRGF0YWJhc2UgY2hlY2sgZXJyb3I6XCIsIGVycm9yKVxuICAgICAgLy8gQ2hlY2sgZm9yIHNwZWNpZmljIGVycm9yIGNvZGVzIHRoYXQgaW5kaWNhdGUgdGFibGUgZG9lc24ndCBleGlzdFxuICAgICAgaWYgKFxuICAgICAgICBlcnJvci5jb2RlID09PSBcIjQyUDAxXCIgfHxcbiAgICAgICAgZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcImRvZXMgbm90IGV4aXN0XCIpIHx8XG4gICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJyZWxhdGlvblwiKSB8fFxuICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwidGFibGVcIilcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICAgIC8vIENoZWNrIGZvciBSTFMvcGVybWlzc2lvbiBlcnJvcnMgKGNvbW1vbiBhZnRlciBlbmFibGluZyBSZWFsdGltZSlcbiAgICAgIGlmIChcbiAgICAgICAgZXJyb3IuY29kZSA9PT0gXCI0MjUwMVwiIHx8XG4gICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJwZXJtaXNzaW9uIGRlbmllZFwiKSB8fFxuICAgICAgICBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwiUkxTXCIpIHx8XG4gICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJwb2xpY3lcIilcbiAgICAgICkge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJEYXRhYmFzZSBleGlzdHMgYnV0IFJMUyBwb2xpY2llcyBtYXkgYmUgYmxvY2tpbmcgYWNjZXNzXCIpXG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgICAgLy8gRm9yIG90aGVyIGVycm9ycywgYXNzdW1lIHRhYmxlIGV4aXN0cyBidXQgdGhlcmUgbWlnaHQgYmUgcGVybWlzc2lvbiBpc3N1ZXNcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coXCJEYXRhYmFzZSBzZXR1cCBjaGVjayBwYXNzZWRcIilcbiAgICByZXR1cm4gdHJ1ZVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJEYXRhYmFzZSBzZXR1cCBjaGVjayBmYWlsZWQ6XCIsIGVycm9yKVxuICAgIC8vIEhhbmRsZSB0aW1lb3V0IGFuZCBvdGhlciBlcnJvcnNcbiAgICBpZiAoZXJyb3IubWVzc2FnZSA9PT0gJ0RhdGFiYXNlIGNoZWNrIHRpbWVvdXQnKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJEYXRhYmFzZSBjaGVjayB0aW1lZCBvdXQgLSBsaWtlbHkgUkxTIHBvbGljeSBpc3N1ZVwiKVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEhlYWRsaW5lIHtcbiAgaWQ/OiBzdHJpbmdcbiAgY2F0ZWdvcnk6IHN0cmluZ1xuICB0aXRsZTogc3RyaW5nXG4gIHVybDogc3RyaW5nXG4gIHNvdXJjZTogc3RyaW5nXG4gIHB1Ymxpc2hlZF9hdDogc3RyaW5nXG4gIGNyZWF0ZWRfYXQ/OiBzdHJpbmdcbiAgaW1hZ2VfdXJsPzogc3RyaW5nXG4gIGF1dGhvcj86IHN0cmluZ1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUhlYWRsaW5lcyhoZWFkbGluZXM6IEhlYWRsaW5lW10pIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oXCJoZWFkbGluZXNcIilcbiAgICAgIC5pbnNlcnQoaGVhZGxpbmVzKVxuICAgICAgLnNlbGVjdCgpXG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzYXZpbmcgaGVhZGxpbmVzOlwiLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYOKchSBTYXZlZCAke2hlYWRsaW5lcy5sZW5ndGh9IGhlYWRsaW5lc2ApXG4gICAgcmV0dXJuIGRhdGFcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgaW4gc2F2ZUhlYWRsaW5lczpcIiwgZXJyb3IpXG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SGVhZGxpbmVzKGNhdGVnb3J5Pzogc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcbiAgICAgIC5mcm9tKFwiaGVhZGxpbmVzXCIpXG4gICAgICAuc2VsZWN0KFwiKlwiKVxuICAgICAgLm9yZGVyKFwiY3JlYXRlZF9hdFwiLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcblxuICAgIGlmIChjYXRlZ29yeSkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcShcImNhdGVnb3J5XCIsIGNhdGVnb3J5KVxuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSBcIjQyUDAxXCIgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcImRvZXMgbm90IGV4aXN0XCIpKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIkhlYWRsaW5lcyB0YWJsZSBkb2VzIG5vdCBleGlzdC4gUGxlYXNlIHJ1biB0aGUgZGF0YWJhc2Ugc2V0dXAuXCIpXG4gICAgICAgIHJldHVybiBbXVxuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YSB8fCBbXVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBoZWFkbGluZXM6XCIsIGVycm9yKVxuICAgIHJldHVybiBbXVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRIZWFkbGluZXNCeUNhdGVnb3J5KCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbShcImhlYWRsaW5lc1wiKVxuICAgICAgLnNlbGVjdChcIipcIilcbiAgICAgIC5vcmRlcihcImNyZWF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSBcIjQyUDAxXCIgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcImRvZXMgbm90IGV4aXN0XCIpKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIkhlYWRsaW5lcyB0YWJsZSBkb2VzIG5vdCBleGlzdC4gUGxlYXNlIHJ1biB0aGUgZGF0YWJhc2Ugc2V0dXAuXCIpXG4gICAgICAgIHJldHVybiB7fVxuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG5cbiAgICAvLyBHcm91cCBoZWFkbGluZXMgYnkgY2F0ZWdvcnkgKG1heCAxMCBwZXIgY2F0ZWdvcnkpXG4gICAgY29uc3QgZ3JvdXBlZEhlYWRsaW5lcyA9IChkYXRhIHx8IFtdKS5yZWR1Y2UoKGFjYywgaGVhZGxpbmUpID0+IHtcbiAgICAgIGlmICghYWNjW2hlYWRsaW5lLmNhdGVnb3J5XSkge1xuICAgICAgICBhY2NbaGVhZGxpbmUuY2F0ZWdvcnldID0gW11cbiAgICAgIH1cbiAgICAgIGlmIChhY2NbaGVhZGxpbmUuY2F0ZWdvcnldLmxlbmd0aCA8IDEwKSB7XG4gICAgICAgIGFjY1toZWFkbGluZS5jYXRlZ29yeV0ucHVzaChoZWFkbGluZSlcbiAgICAgIH1cbiAgICAgIHJldHVybiBhY2NcbiAgICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBIZWFkbGluZVtdPilcblxuICAgIHJldHVybiBncm91cGVkSGVhZGxpbmVzXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGhlYWRsaW5lcyBieSBjYXRlZ29yeTpcIiwgZXJyb3IpXG4gICAgcmV0dXJuIHt9XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFudXBPbGRIZWFkbGluZXMoKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKFwiaGVhZGxpbmVzXCIpXG4gICAgICAuZGVsZXRlKClcbiAgICAgIC5sdChcImNyZWF0ZWRfYXRcIiwgbmV3IERhdGUoRGF0ZS5ub3coKSAtIDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpKVxuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgY2xlYW5pbmcgdXAgb2xkIGhlYWRsaW5lczpcIiwgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFwi4pyFIENsZWFuZWQgdXAgb2xkIGhlYWRsaW5lc1wiKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbiBjbGVhbnVwT2xkSGVhZGxpbmVzOlwiLCBlcnJvcilcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja0hlYWRsaW5lc1RhYmxlU2V0dXAoKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKFwiaGVhZGxpbmVzXCIpXG4gICAgICAuc2VsZWN0KFwiaWRcIilcbiAgICAgIC5saW1pdCgxKVxuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gXCI0MlAwMVwiIHx8IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJkb2VzIG5vdCBleGlzdFwiKSkge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWVcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiSGVhZGxpbmVzIHRhYmxlIHNldHVwIGNoZWNrIGZhaWxlZDpcIiwgZXJyb3IpXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBQZXJwbGV4aXR5TmV3cyB7XG4gIGlkPzogc3RyaW5nXG4gIGNhdGVnb3J5OiBzdHJpbmdcbiAgdGl0bGU6IHN0cmluZ1xuICB0aXRsZV9lbj86IHN0cmluZ1xuICB1cmw6IHN0cmluZ1xuICBpbnNlcnRlZF9hdD86IHN0cmluZ1xuICB1cmxfaGFzaD86IHN0cmluZ1xuICBhcnRpY2xlX3N0YXR1czogJ3BlbmRpbmcnIHwgJ2VucmljaGVkJyB8ICdyZWFkeSdcbiAgYXJ0aWNsZV9odG1sPzogc3RyaW5nXG4gIGxlZGU/OiBzdHJpbmdcbiAgaW1hZ2VfcHJvbXB0Pzogc3RyaW5nXG4gIGltYWdlX3N0YXR1czogJ3BlbmRpbmcnIHwgJ3JlYWR5JyB8ICdmYWlsZWQnXG4gIGltYWdlX3VybD86IHN0cmluZ1xuICBpbWFnZV9saWNlbnNlPzogc3RyaW5nXG4gIFxuICAvLyBFbmhhbmNlZCBzdHJ1Y3R1cmVkIGNvbnRlbnQgZmllbGRzXG4gIGVuaGFuY2VkX3RpdGxlPzogc3RyaW5nXG4gIHN1bW1hcnk/OiBzdHJpbmdcbiAga2V5X3BvaW50cz86IHN0cmluZ1tdXG4gIHdoeV9pdF9tYXR0ZXJzPzogc3RyaW5nXG4gIHN0cnVjdHVyZWRfc291cmNlcz86IHtcbiAgICBjaXRhdGlvbnM6IHN0cmluZ1tdXG4gICAgc291cmNlczogQXJyYXk8e1xuICAgICAgdGl0bGU6IHN0cmluZ1xuICAgICAgdXJsOiBzdHJpbmdcbiAgICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nXG4gICAgICBkb21haW4/OiBzdHJpbmdcbiAgICB9PlxuICAgIGdlbmVyYXRlZF9hdDogc3RyaW5nXG4gIH1cbiAgXG4gIHNvdXJjZT86IHN0cmluZ1xuICBhdXRob3I/OiBzdHJpbmdcbiAgcGVycGxleGl0eV9tb2RlbD86IHN0cmluZ1xuICBnZW5lcmF0aW9uX2Nvc3Q/OiBudW1iZXJcbiAgc2VhcmNoX3F1ZXJpZXM/OiBzdHJpbmdbXVxuICBjaXRhdGlvbnM/OiBhbnlcbiAgY3JlYXRlZF9hdD86IHN0cmluZ1xuICB1cGRhdGVkX2F0Pzogc3RyaW5nXG59XG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFBlcnBsZXhpdHlOZXdzKGNhdGVnb3J5Pzogc3RyaW5nLCBsaW1pdCA9IDIwKSB7XG4gIHRyeSB7XG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcbiAgICAgIC5mcm9tKFwicGVycGxleGl0eV9uZXdzXCIpXG4gICAgICAuc2VsZWN0KFwiKlwiKVxuICAgICAgLmVxKFwiYXJ0aWNsZV9zdGF0dXNcIiwgXCJyZWFkeVwiKVxuICAgICAgLm9yZGVyKFwidXBkYXRlZF9hdFwiLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcblxuICAgIGlmIChjYXRlZ29yeSkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcShcImNhdGVnb3J5XCIsIGNhdGVnb3J5KVxuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5LmxpbWl0KGxpbWl0KVxuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gXCI0MlAwMVwiIHx8IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJkb2VzIG5vdCBleGlzdFwiKSkge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJQZXJwbGV4aXR5IG5ld3MgdGFibGUgZG9lcyBub3QgZXhpc3QuIFBsZWFzZSBydW4gdGhlIGRhdGFiYXNlIHNldHVwLlwiKVxuICAgICAgICByZXR1cm4gW11cbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGEgfHwgW11cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgUGVycGxleGl0eSBuZXdzOlwiLCBlcnJvcilcbiAgICByZXR1cm4gW11cbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGVycGxleGl0eU5ld3NCeUNhdGVnb3J5KCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbShcInBlcnBsZXhpdHlfbmV3c1wiKVxuICAgICAgLnNlbGVjdChcIipcIilcbiAgICAgIC5lcShcImFydGljbGVfc3RhdHVzXCIsIFwicmVhZHlcIilcbiAgICAgIC5vcmRlcihcInVwZGF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSBcIjQyUDAxXCIgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcImRvZXMgbm90IGV4aXN0XCIpKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIlBlcnBsZXhpdHkgbmV3cyB0YWJsZSBkb2VzIG5vdCBleGlzdC4gUGxlYXNlIHJ1biB0aGUgZGF0YWJhc2Ugc2V0dXAuXCIpXG4gICAgICAgIHJldHVybiB7fVxuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG5cbiAgICAvLyBHcm91cCBieSBjYXRlZ29yeSAobWF4IDEwIHBlciBjYXRlZ29yeSlcbiAgICBjb25zdCBncm91cGVkTmV3cyA9IChkYXRhIHx8IFtdKS5yZWR1Y2UoKGFjYywgYXJ0aWNsZSkgPT4ge1xuICAgICAgaWYgKCFhY2NbYXJ0aWNsZS5jYXRlZ29yeV0pIHtcbiAgICAgICAgYWNjW2FydGljbGUuY2F0ZWdvcnldID0gW11cbiAgICAgIH1cbiAgICAgIGlmIChhY2NbYXJ0aWNsZS5jYXRlZ29yeV0ubGVuZ3RoIDwgMTApIHtcbiAgICAgICAgYWNjW2FydGljbGUuY2F0ZWdvcnldLnB1c2goYXJ0aWNsZSlcbiAgICAgIH1cbiAgICAgIHJldHVybiBhY2NcbiAgICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBQZXJwbGV4aXR5TmV3c1tdPilcblxuICAgIHJldHVybiBncm91cGVkTmV3c1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBQZXJwbGV4aXR5IG5ld3MgYnkgY2F0ZWdvcnk6XCIsIGVycm9yKVxuICAgIHJldHVybiB7fVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1BlcnBsZXhpdHlOZXdzVGFibGVTZXR1cCgpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oXCJwZXJwbGV4aXR5X25ld3NcIilcbiAgICAgIC5zZWxlY3QoXCJpZFwiKVxuICAgICAgLmxpbWl0KDEpXG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSBcIjQyUDAxXCIgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcImRvZXMgbm90IGV4aXN0XCIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJQZXJwbGV4aXR5IG5ld3MgdGFibGUgc2V0dXAgY2hlY2sgZmFpbGVkOlwiLCBlcnJvcilcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiRXJyb3IiLCJzdXBhYmFzZSIsInNhdmVBcnRpY2xlIiwiYXJ0aWNsZSIsImRhdGEiLCJleGlzdGluZyIsImZyb20iLCJzZWxlY3QiLCJlcSIsInVybCIsInNpbmdsZSIsImNvbnNvbGUiLCJsb2ciLCJ0aXRsZSIsIkRhdGUiLCJjcmVhdGVkX2F0IiwidG9Mb2NhbGVTdHJpbmciLCJza2lwcGVkIiwiZXJyb3IiLCJpbnNlcnQiLCJjb250ZW50Iiwic3VtbWFyeSIsImFpX3N1bW1hcnkiLCJzb3VyY2UiLCJhdXRob3IiLCJpbWFnZV91cmwiLCJpbWFnZVVybCIsImNhdGVnb3J5IiwiaXNfYWlfZW5oYW5jZWQiLCJvcmlnaW5hbF9hcnRpY2xlX2lkIiwiZW5oYW5jZW1lbnRfbWV0YWRhdGEiLCJnZXRBcnRpY2xlU3RhdHMiLCJvcmRlciIsImFzY2VuZGluZyIsInN0YXRzIiwidG90YWwiLCJsZW5ndGgiLCJieVNvdXJjZSIsImxhdGVzdCIsIm9sZGVzdCIsImZvckVhY2giLCJnZXRCYWxhbmNlZEFydGljbGVzIiwicGFnZSIsImxpbWl0IiwiZmlsdGVycyIsImdldEFydGljbGVzUmVndWxhciIsInNvdXJjZXMiLCJhcnRpY2xlc1BlclNvdXJjZSIsIk1hdGgiLCJtYXgiLCJmbG9vciIsImV4dHJhQXJ0aWNsZXMiLCJhbGxBcnRpY2xlcyIsImkiLCJzb3VyY2VMaW1pdCIsInF1ZXJ5IiwiaW4iLCJpc0FpRW5oYW5jZWQiLCJ1bmRlZmluZWQiLCJsYW5ndWFnZSIsIm9yIiwic3RhcnRJbmRleCIsImVuZEluZGV4IiwicmFuZ2UiLCJwdXNoIiwic29ydCIsImEiLCJiIiwiZ2V0VGltZSIsInNsaWNlIiwiaGFzRW5yaWNobWVudCIsIm5vdCIsImlzIiwiY29kZSIsIm1lc3NhZ2UiLCJpbmNsdWRlcyIsIndhcm4iLCJnZXRBcnRpY2xlcyIsInNlYXJjaEFydGljbGVzIiwiZ2V0QXJ0aWNsZUJ5SWQiLCJpZCIsInNhbXBsZUFydGljbGVzIiwibWFwIiwiZ2V0RW5oYW5jZW1lbnRTdGF0cyIsInJwYyIsImNoZWNrRGF0YWJhc2VTZXR1cCIsInRpbWVvdXRQcm9taXNlIiwiUHJvbWlzZSIsIl8iLCJyZWplY3QiLCJzZXRUaW1lb3V0IiwiZGJQcm9taXNlIiwicmFjZSIsInNhdmVIZWFkbGluZXMiLCJoZWFkbGluZXMiLCJnZXRIZWFkbGluZXMiLCJnZXRIZWFkbGluZXNCeUNhdGVnb3J5IiwiZ3JvdXBlZEhlYWRsaW5lcyIsInJlZHVjZSIsImFjYyIsImhlYWRsaW5lIiwiY2xlYW51cE9sZEhlYWRsaW5lcyIsImRlbGV0ZSIsImx0Iiwibm93IiwidG9JU09TdHJpbmciLCJjaGVja0hlYWRsaW5lc1RhYmxlU2V0dXAiLCJnZXRQZXJwbGV4aXR5TmV3cyIsImdldFBlcnBsZXhpdHlOZXdzQnlDYXRlZ29yeSIsImdyb3VwZWROZXdzIiwiY2hlY2tQZXJwbGV4aXR5TmV3c1RhYmxlU2V0dXAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/ws","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/isows"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftopics%2Froute&page=%2Fapi%2Ftopics%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftopics%2Froute.ts&appDir=%2FUsers%2Fmarkau%2Fpanora8A%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmarkau%2Fpanora8A&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();