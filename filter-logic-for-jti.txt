Below is a region-aware filtering model you can drop into your HKI Journey Time UI. I’ve:
	1.	Validated the official code lists (location + destination) from the Transport Dept’s Journey Time Indicators (2nd Gen) data spec.
	2.	Cross-checked dataset context (update freq ~2 min; transport dept source).
	3.	Built a region classification layer (HK Island / Kowloon / New Territories) and treatment rules for the three cross-harbour tunnel destinations (CH/EH/WH).

⸻

1. Canonical Code Tables

1.1 Location IDs → Region

Rule: Prefix H ⇒ Hong Kong Island; K ⇒ Kowloon; N or SJ ⇒ New Territories (strategic junctions are all off HK Island/Kowloon core, so group under NT for macro filters). Derived from the official JTI location list in the data spec (codes + physical coordinates).

Region	Location Codes	Notes (abbrev)
HK Island	H1–H9, H11	Central/Admiralty, Wan Chai, CWB, North Point, Quarry Bay, Repulse Bay, Deep Water Bay, Aberdeen, Ap Lei Chau, Sai Wan Ho.
Kowloon	K01–K07	Yau Ma Tei, Hung Hom, Waterloo Rd, Mong Kok, Sham Shui Po, Kowloon Tong, Wong Tai Sin.
New Territories	N01–N13, SJ1–SJ5	Sha Tin, Tai Po, Fanling, Tuen Mun, Yuen Long, Sai Kung / TKO cluster, Tai W ￼ ￼ ￼i Po Rd, Tate’s Cairn Hwy, Tolo Hwy, San Tin Hwy, Tuen Mun Rd).  ￼


⸻

1.2 Destination IDs → Base Meaning

Below are the JTI destination codes and their sign text (shortened). I’ve added a UI Region Tag for filtering (next section explains tunnel rules). Codes and text from official spec.  ￼

Code	Sign Text (spec)	UI Region Tag*
CH	Cross Harbour Tunnel	tunnel (dynamic)
EH	Eastern Harbour Crossing	tunnel (dynamic)
WH	Western Harbour Crossing	tunnel (dynamic)
ABT	Wan Chai via Aberdeen Tunnel	HK
WNCG	Wan Chai via WNC Gap Rd	HK
PFL	Central via Pok Fu Lam Rd	HK
ACTT	Airport via Route 3	NT
TMCLK	Airport via TM-CLK Tunnel	NT
ATL	Airport via Tai Lam Tunnel	NT
ATSCA	Airport to SCAR	NT
SMT	Tsuen Wan via Shing Mun Tunnel	NT
SSCPR	Sheung Shui via Castle Peak Rd	NT
SSYLH	Sheung Shui via Route 9	NT
TKTL	Ting Kau via Tai Lam Tunnel	NT
TKTM	Ting Kau via Tuen Mun Rd	NT
TLH	Sha Tin via Tolo Highway	NT
TPR	Sha Tin via Tai Po Rd	NT
TWCP	Tsuen Wan (W) via Castle Peak	NT
TWTM	Tsuen Wan (W) via Tuen Mun	NT
KTPR	Kowloon via Tai Po Rd	Kln
TSCA	Kowloon (W) via Route 8	Kln
TCT	Kowloon (E) via Tate’s Cairn Tunnel	Kln
LRT	Kowloon (C) via Lion Rock Tunnel	Kln
CWBR	Kowloon via Clear Water Bay Rd	Kln
MOS	Kowloon via Route 2	Kln
TKOLTT	Kowloon via TKO Lam Tin Tunnel	Kln
TKOT	Kowloon via TKO Tunnel	Kln
*Tunnel destination handling below.  ￼		


⸻

2. Region Resolution Rules

You need a deterministic function to bucket each (locationId, destinationId) pair into Start Region and Destination Region for the UI filters.

Start Region: Determined solely from locationId prefix (H/K/N/SJ). See §1.1.  ￼

Destination Region:
	1.	If destinationId is one of the 3 cross-harbour tunnels (CH,EH,WH):
	•	If start region = HK Island, treat destination region = Kowloon (user is heading off-Island through the tunnel).
	•	Else (start = Kowloon or NT), treat destination region = Hong Kong Island (user is heading to Island via the harbour crossing).
Rationale: JTIS signs show tunnel travel time to the harbour crossing; commuters interpret that as a path to “the other side” of the harbour. This aligns with the Transport Dept description that JTIS helps drivers choose among the three cross-harbour options in either direction.  ￼ ￼
	2.	Else, map via UI Region Tag in §1.2 (direct classification using the sign’s target area — e.g., “Kowloon (E)” ⇒ Kowloon; “Airport” / “Tsuen Wan” ⇒ NT).  ￼

⸻

3. 9 Start+Destination Filter Scenarios

Below are the destination code sets that will be returned when a user picks a Start Region (HK / Kln / NT) and a Destination Region (HK / Kln / NT). Use these to pre-filter the ~50 live JTI pairs you receive from the API; actual availability depends on which (locationId, destinationId) rows are present in the XML refresh. (JTIS refreshes ~every 2 minutes; always filter after ingest.)  ￼ ￼ ￼

Legend
	•	HK→… means user selected Start=Hong Kong Island.
	•	Lists show destination codes you should include when filtering live data rows.
	•	Cross-harbour tunnel codes shift sides per Rule #1 above.

⸻

3.1 HK → HK

Show HK-targeted signage only: ABT, WNCG, PFL.  ￼

3.2 HK → Kowloon

Include: CH, EH, WH (tunnels out of Island) + Kowloon-tagged codes: KTPR, TSCA, TCT, LRT, CWBR, MOS, TKOLTT, TKOT.  ￼

3.3 HK → New Territories

Include NT-tagged codes (airport + NT districts): ACTT, TMCLK, ATL, ATSCA, SMT, SSCPR, SSYLH, TKTL, TKTM, TLH, TPR, TWCP, TWTM.  ￼

⸻

3.4 Kowloon → HK

Include cross-harbour tunnels CH, EH, WH (now inbound to Island) + HK-tagged codes ABT, WNCG, PFL.  ￼ ￼

3.5 Kowloon → Kowloon

Kowloon-tagged set (same as §3.2 minus tunnels): KTPR, TSCA, TCT, LRT, CWBR, MOS, TKOLTT, TKOT.  ￼

3.6 Kowloon → New Territories

NT-tagged set: ACTT, TMCLK, ATL, ATSCA, SMT, SSCPR, SSYLH, TKTL, TKTM, TLH, TPR, TWCP, TWTM.  ￼

⸻

3.7 New Territories → HK

Include cross-harbour tunnels CH, EH, WH (ultimately to Island) + HK-tagged ABT, WNCG, PFL.  ￼ ￼

3.8 New Territories → Kowloon

Kowloon-tagged: KTPR, TSCA, TCT, LRT, CWBR, MOS, TKOLTT, TKOT.  ￼

3.9 New Territories → New Territories

NT-tagged: ACTT, TMCLK, ATL, ATSCA, SMT, SSCPR, SSYLH, TKTL, TKTM, TLH, TPR, TWCP, TWTM.  ￼

⸻

4. Additional 6 Macro Scenarios (Start-only & Destination-only)

You asked for “+3 with start and without destination +3 with destination without route.” I interpret:

4.1 Start Region only (Destination = All)

Return all rows whose locationId is in the selected region, regardless of destination. Use region prefixes from §1.1.  ￼
	•	Start=HK → all records with locationId H*.
	•	Start=Kln → all records with locationId K*.
	•	Start=NT → all records with locationId N* or SJ*.

(JTIS feed rows are per JTI sign; multiple destination rows may exist per sign.)  ￼ ￼

⸻

4.2 Destination Region only (Start = All)

Return all rows whose resolved Destination Region (per §2) matches selection, ignoring start. Helpful when commuter just wants “all times heading to HK Island” from anywhere.  ￼ ￼
	•	Dest=HK → HK-tagged + (CH,EH,WH where start≠HK; handle in aggregation by evaluating each row).
	•	Dest=Kln → Kowloon-tagged + (CH,EH,WH where start=HK).
	•	Dest=NT → NT-tagged.

Because tunnel rows are directional (start dependent), compute region dynamically at row evaluation time.  ￼

⸻

5. Filtering Algorithm (Pseudo-TS)

type Region = 'hk' | 'kln' | 'nt';

function regionForLocation(locationId: string): Region {
  if (locationId.startsWith('H')) return 'hk';
  if (locationId.startsWith('K')) return 'kln';
  // N / SJ default to NT
  return 'nt';
}

const DEST_REGION_BASE: Record<string, Region | 'tunnel'> = {
  CH: 'tunnel', EH: 'tunnel', WH: 'tunnel',
  ABT: 'hk', WNCG: 'hk', PFL: 'hk',
  ACTT: 'nt', TMCLK: 'nt', ATL: 'nt', ATSCA: 'nt',
  SMT: 'nt', SSCPR: 'nt', SSYLH: 'nt', TKTL: 'nt', TKTM: 'nt',
  TLH: 'nt', TPR: 'nt', TWCP: 'nt', TWTM: 'nt',
  KTPR: 'kln', TSCA: 'kln', TCT: 'kln', LRT: 'kln',
  CWBR: 'kln', MOS: 'kln', TKOLTT: 'kln', TKOT: 'kln',
};

function regionForDestination(destId: string, startRegion: Region): Region {
  const base = DEST_REGION_BASE[destId];
  if (base === 'tunnel') {
    return startRegion === 'hk' ? 'kln' : 'hk';
  }
  return base ?? 'nt';
}

interface JTRow {
  locationId: string;
  destinationId: string;
  // ...journeyData...
}

function filterJourneyTimes(
  rows: JTRow[],
  opts: { start?: Region; dest?: Region }
): JTRow[] {
  return rows.filter(r => {
    const sReg = regionForLocation(r.locationId);
    const dReg = regionForDestination(r.destinationId, sReg);
    if (opts.start && sReg !== opts.start) return false;
    if (opts.dest && dReg !== opts.dest) return false;
    return true;
  });
}

Attach this to your fetch cycle (JTIS XML → parsed rows). Refresh every ~2 minutes to match dataset cadence.  ￼ ￼ ￼

⸻

6. Implementation Notes

Parsing: JTIS feed is XML; parse <LOCATION_ID> + <DESTINATION_ID> nodes into rows. (Your uploaded route.ts already regex-parses these tags — keep that; just apply region mapping post-parse.)  ￼ ￼

Display Grouping: After filtering, group by tunnel class (expressway / trunk / local) if you want a richer UI segmentation (you already maintain expressways, trunkRoads, localRoads arrays in code). This aligns with how JTIS differentiates major corridors vs secondary approaches.  ￼ ￼

Update Strategy: Cache parsed rows and recompute filtered views client-side so changing Start/Dest tabs is instant; re-fetch server-side on a rolling 120s interval (matches your revalidate hint and dataset’s 2-min refresh).  ￼ ￼

⸻

7. Quick Checklist for You
	•	Integrate region mapping constants (§5) into your API layer (route.ts).
	•	On fetch, parse rows → annotate {startRegion, destRegion}.
	•	Precompute 15 scenario buckets (9 + 3 start-only + 3 dest-only) into a lookup object for instant UI switching.
	•	Surface counts per bucket to show coverage (“HK→Kln: 18 live routes”) — nice UX touch for commuters scanning options.  ￼
	•	Optionally collapse strategic duplicates (e.g., multiple NT JTIs feeding the same tunnel) with min/avg time badges.

⸻

Let me know:
	1.	Do you want me to patch your /mnt/data/route.ts with this logic?
	2.	Should the UI show best tunnel highlight when user picks HK↔Kln (compare CH/EH/WH)?
	3.	Do you need Chinese labels bundled?

I can generate a drop-in TS utility + type defs next.